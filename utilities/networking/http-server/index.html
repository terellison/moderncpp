
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Modern C++ Snippets">
      
      
      
      
        <link rel="canonical" href="https://alandefreitas.github.io/moderncpp/utilities/networking/http-server/">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.8">
    
    
      
        <title>Http server - Modern C++</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-109858331-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#http-server" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://alandefreitas.github.io/moderncpp/" title="Modern C++" class="md-header-nav__button md-logo" aria-label="Modern C++">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Modern C++
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Http server
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/alandefreitas/moderncpp" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    alandefreitas/moderncpp
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://alandefreitas.github.io/moderncpp/" title="Modern C++" class="md-nav__button md-logo" aria-label="Modern C++">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Modern C++
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/alandefreitas/moderncpp" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    alandefreitas/moderncpp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../quick-start/" class="md-nav__link">
        Quick Start
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
      
      <label class="md-nav__link" for="nav-3">
        Basic Syntax
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Basic Syntax" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          Basic Syntax
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1" >
      
      <label class="md-nav__link" for="nav-3-1">
        Input / Output
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Input / Output" data-md-level="2">
        <label class="md-nav__title" for="nav-3-1">
          <span class="md-nav__icon md-icon"></span>
          Input / Output
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/input--output/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/input--output/hello-world/" class="md-nav__link">
        Hello World
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/input--output/input/" class="md-nav__link">
        Input
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/input--output/output/" class="md-nav__link">
        Output
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/input--output/format/" class="md-nav__link">
        Format
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/input--output/tabulate/" class="md-nav__link">
        Tabulate
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" >
      
      <label class="md-nav__link" for="nav-3-2">
        Control flow
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Control flow" data-md-level="2">
        <label class="md-nav__title" for="nav-3-2">
          <span class="md-nav__icon md-icon"></span>
          Control flow
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/control-flow/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/control-flow/sequential/" class="md-nav__link">
        Sequential
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/control-flow/conditional/" class="md-nav__link">
        Conditional
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/control-flow/loops/" class="md-nav__link">
        Loops
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3" >
      
      <label class="md-nav__link" for="nav-3-3">
        Data types
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Data types" data-md-level="2">
        <label class="md-nav__title" for="nav-3-3">
          <span class="md-nav__icon md-icon"></span>
          Data types
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/data-types/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/data-types/fundamental-data-types/" class="md-nav__link">
        Fundamental Data Types
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/data-types/operators/" class="md-nav__link">
        Operators
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/data-types/auto/" class="md-nav__link">
        Auto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/data-types/constants/" class="md-nav__link">
        Constants
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4" >
      
      <label class="md-nav__link" for="nav-3-4">
        Basic Data Types
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Basic Data Types" data-md-level="2">
        <label class="md-nav__title" for="nav-3-4">
          <span class="md-nav__icon md-icon"></span>
          Basic Data Types
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/basic-data-types/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/basic-data-types/raw-arrays/" class="md-nav__link">
        Raw arrays
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/basic-data-types/arrays/" class="md-nav__link">
        Arrays
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/basic-data-types/vectors/" class="md-nav__link">
        Vectors
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/basic-data-types/strings/" class="md-nav__link">
        Strings
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/basic-data-types/move/" class="md-nav__link">
        Move
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/basic-data-types/aggregate-initialization/" class="md-nav__link">
        Aggregate initialization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/basic-data-types/structured-binding/" class="md-nav__link">
        Structured binding
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5" >
      
      <label class="md-nav__link" for="nav-3-5">
        Pointers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pointers" data-md-level="2">
        <label class="md-nav__title" for="nav-3-5">
          <span class="md-nav__icon md-icon"></span>
          Pointers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/pointers/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/pointers/raw-pointers/" class="md-nav__link">
        Raw Pointers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/pointers/smart-pointers/" class="md-nav__link">
        Smart pointers
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6" >
      
      <label class="md-nav__link" for="nav-3-6">
        Functions
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Functions" data-md-level="2">
        <label class="md-nav__title" for="nav-3-6">
          <span class="md-nav__icon md-icon"></span>
          Functions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/functions/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/functions/function/" class="md-nav__link">
        Function
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/functions/lambda/" class="md-nav__link">
        Lambda
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-7" type="checkbox" id="nav-3-7" >
      
      <label class="md-nav__link" for="nav-3-7">
        Files
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Files" data-md-level="2">
        <label class="md-nav__title" for="nav-3-7">
          <span class="md-nav__icon md-icon"></span>
          Files
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/files/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/files/file-streams/" class="md-nav__link">
        File streams
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/files/filesystem/" class="md-nav__link">
        Filesystem
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
      
      <label class="md-nav__link" for="nav-4">
        Algorithms / Data Structures
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Algorithms / Data Structures" data-md-level="1">
        <label class="md-nav__title" for="nav-4">
          <span class="md-nav__icon md-icon"></span>
          Algorithms / Data Structures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-1" type="checkbox" id="nav-4-1" >
      
      <label class="md-nav__link" for="nav-4-1">
        Date and time
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Date and time" data-md-level="2">
        <label class="md-nav__title" for="nav-4-1">
          <span class="md-nav__icon md-icon"></span>
          Date and time
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/date-and-time/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/date-and-time/clock/" class="md-nav__link">
        Clock
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/date-and-time/datetime/" class="md-nav__link">
        Datetime
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2" >
      
      <label class="md-nav__link" for="nav-4-2">
        Random
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Random" data-md-level="2">
        <label class="md-nav__title" for="nav-4-2">
          <span class="md-nav__icon md-icon"></span>
          Random
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/random/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/random/random/" class="md-nav__link">
        Random
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/random/pcg/" class="md-nav__link">
        PCG
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3" >
      
      <label class="md-nav__link" for="nav-4-3">
        Template
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Template" data-md-level="2">
        <label class="md-nav__title" for="nav-4-3">
          <span class="md-nav__icon md-icon"></span>
          Template
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/template/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/template/template-function/" class="md-nav__link">
        Template function
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/template/template-aliases/" class="md-nav__link">
        Template aliases
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/template/concepts/" class="md-nav__link">
        Concepts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/template/sfinae/" class="md-nav__link">
        SFINAE
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4" >
      
      <label class="md-nav__link" for="nav-4-4">
        Algorithm
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Algorithm" data-md-level="2">
        <label class="md-nav__title" for="nav-4-4">
          <span class="md-nav__icon md-icon"></span>
          Algorithm
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/algorithm/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/algorithm/searching/" class="md-nav__link">
        Searching
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/algorithm/sorting/" class="md-nav__link">
        Sorting
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/algorithm/basic-algorithms/" class="md-nav__link">
        Basic Algorithms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/algorithm/ranges/" class="md-nav__link">
        Ranges
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5" >
      
      <label class="md-nav__link" for="nav-4-5">
        Data structures
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Data structures" data-md-level="2">
        <label class="md-nav__title" for="nav-4-5">
          <span class="md-nav__icon md-icon"></span>
          Data structures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/data-structures/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/data-structures/sequential-containers/" class="md-nav__link">
        Sequential Containers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/data-structures/associative-containers/" class="md-nav__link">
        Associative Containers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/data-structures/memory-resource/" class="md-nav__link">
        Memory resource
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/data-structures/span/" class="md-nav__link">
        Span
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/data-structures/bitset/" class="md-nav__link">
        Bitset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/data-structures/spatial-containers/" class="md-nav__link">
        Spatial Containers
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-6" type="checkbox" id="nav-4-6" >
      
      <label class="md-nav__link" for="nav-4-6">
        Heterogeneous Types
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Heterogeneous Types" data-md-level="2">
        <label class="md-nav__title" for="nav-4-6">
          <span class="md-nav__icon md-icon"></span>
          Heterogeneous Types
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/heterogeneous-types/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/heterogeneous-types/tuples/" class="md-nav__link">
        Tuples
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/heterogeneous-types/any/" class="md-nav__link">
        Any
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/heterogeneous-types/optional/" class="md-nav__link">
        Optional
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/heterogeneous-types/variant/" class="md-nav__link">
        Variant
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" >
      
      <label class="md-nav__link" for="nav-5">
        Programming Paradigms
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Programming Paradigms" data-md-level="1">
        <label class="md-nav__title" for="nav-5">
          <span class="md-nav__icon md-icon"></span>
          Programming Paradigms
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-1" type="checkbox" id="nav-5-1" >
      
      <label class="md-nav__link" for="nav-5-1">
        Basic Paradigms
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Basic Paradigms" data-md-level="2">
        <label class="md-nav__title" for="nav-5-1">
          <span class="md-nav__icon md-icon"></span>
          Basic Paradigms
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/basic-paradigms/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/basic-paradigms/polymorphism/" class="md-nav__link">
        Polymorphism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/basic-paradigms/shared-from-this/" class="md-nav__link">
        Shared from this
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/basic-paradigms/metaprogramming/" class="md-nav__link">
        Metaprogramming
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/basic-paradigms/crtp/" class="md-nav__link">
        CRTP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/basic-paradigms/sfinae/" class="md-nav__link">
        SFINAE
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2" >
      
      <label class="md-nav__link" for="nav-5-2">
        Parallelism
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Parallelism" data-md-level="2">
        <label class="md-nav__title" for="nav-5-2">
          <span class="md-nav__icon md-icon"></span>
          Parallelism
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/parallelism/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/parallelism/execution-policies/" class="md-nav__link">
        Execution Policies
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/parallelism/threads/" class="md-nav__link">
        Threads
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/parallelism/executors/" class="md-nav__link">
        Executors
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/parallelism/timers/" class="md-nav__link">
        Timers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/parallelism/signals/" class="md-nav__link">
        Signals
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/parallelism/async/" class="md-nav__link">
        Async++
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
      
      <label class="md-nav__link" for="nav-6">
        Utilities
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Utilities" data-md-level="1">
        <label class="md-nav__title" for="nav-6">
          <span class="md-nav__icon md-icon"></span>
          Utilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-1" type="checkbox" id="nav-6-1" >
      
      <label class="md-nav__link" for="nav-6-1">
        Regular Expressions
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Regular Expressions" data-md-level="2">
        <label class="md-nav__title" for="nav-6-1">
          <span class="md-nav__icon md-icon"></span>
          Regular Expressions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../regular-expressions/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../regular-expressions/regex/" class="md-nav__link">
        Regex
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2" checked>
      
      <label class="md-nav__link" for="nav-6-2">
        Networking
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Networking" data-md-level="2">
        <label class="md-nav__title" for="nav-6-2">
          <span class="md-nav__icon md-icon"></span>
          Networking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../network/" class="md-nav__link">
        Network
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../async-network/" class="md-nav__link">
        Async Network
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Http server
      </a>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" >
      
      <label class="md-nav__link" for="nav-7">
        GUIs
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="GUIs" data-md-level="1">
        <label class="md-nav__title" for="nav-7">
          <span class="md-nav__icon md-icon"></span>
          GUIs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guis/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guis/qt/" class="md-nav__link">
        Qt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guis/opengl--sdl/" class="md-nav__link">
        OpenGL + SDL
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guis/opengl--glfw/" class="md-nav__link">
        OpenGL + GLFW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guis/imgui/" class="md-nav__link">
        IMGUI
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guis/webview/" class="md-nav__link">
        Webview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guis/system-tray/" class="md-nav__link">
        System tray
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8" >
      
      <label class="md-nav__link" for="nav-8">
        Testing
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Testing" data-md-level="1">
        <label class="md-nav__title" for="nav-8">
          <span class="md-nav__icon md-icon"></span>
          Testing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/catch2/" class="md-nav__link">
        Catch2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/boostut/" class="md-nav__link">
        boost.ut
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/source-location/" class="md-nav__link">
        Source Location
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/plots/" class="md-nav__link">
        Plots
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../cmake-functions/" class="md-nav__link">
        CMake functions
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10" >
      
      <label class="md-nav__link" for="nav-10">
        Installing a C++20 compiler
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installing a C++20 compiler" data-md-level="1">
        <label class="md-nav__title" for="nav-10">
          <span class="md-nav__icon md-icon"></span>
          Installing a C++20 compiler
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../installing-a-c20-compiler/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../installing-a-c20-compiler/linux/" class="md-nav__link">
        Linux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../installing-a-c20-compiler/mac-os/" class="md-nav__link">
        Mac OS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../installing-a-c20-compiler/windows/" class="md-nav__link">
        Windows
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../get-involved/" class="md-nav__link">
        Get involved
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="http-server">Http server</h1>
<p>main.cpp</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">//</span>
<span class="c1">// main.cpp</span>
<span class="c1">// ~~~~~~~~</span>
<span class="c1">//</span>
<span class="c1">// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)</span>
<span class="c1">//</span>
<span class="c1">// Distributed under the Boost Software License, Version 1.0. (See accompanying</span>
<span class="c1">// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)</span>
<span class="c1">//</span>

<span class="cp">#include</span> <span class="cpf">&quot;server.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
    <span class="c1">// - Move this to examples</span>
    <span class="c1">// - Replace these snippets with an http server library</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="c1">// Check command line arguments.</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Usage: http_server &lt;address&gt; &lt;port&gt; &lt;doc_root&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;  For IPv4, try: &quot;</span><span class="p">;</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;    receiver 0.0.0.0 80 .</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;  For IPv6, try: &quot;</span><span class="p">;</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;    receiver 0::0 80 .</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// Initialise the server</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">address</span> <span class="o">=</span> <span class="n">argc</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">?</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">:</span> <span class="s">&quot;0.0.0.0&quot;</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">port</span> <span class="o">=</span> <span class="n">argc</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="o">?</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">:</span> <span class="s">&quot;80&quot;</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">doc_root</span> <span class="o">=</span> <span class="n">argc</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="o">?</span> <span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">:</span> <span class="s">&quot;.&quot;</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Server address: http://&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">address</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">port</span>
                  <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
        <span class="n">http</span><span class="o">::</span><span class="n">server</span><span class="o">::</span><span class="n">server</span> <span class="n">s</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">doc_root</span><span class="p">);</span>

        <span class="c1">// Run the server until stopped.</span>
        <span class="n">s</span><span class="p">.</span><span class="n">run</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">exception</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;exception: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p>server.hpp</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">//</span>
<span class="c1">// server.hpp</span>
<span class="c1">// ~~~~~~~~~~</span>
<span class="c1">//</span>
<span class="c1">// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)</span>
<span class="c1">//</span>
<span class="c1">// Distributed under the Boost Software License, Version 1.0. (See accompanying</span>
<span class="c1">// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)</span>
<span class="c1">//</span>

<span class="cp">#ifndef HTTP_SERVER_HPP</span>
<span class="cp">#define HTTP_SERVER_HPP</span>

<span class="cp">#include</span> <span class="cpf">&quot;connection.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;connection_manager.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;request_handler.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;asio.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">http</span><span class="o">::</span><span class="n">server</span> <span class="p">{</span>

    <span class="c1">/// The top-level class of the HTTP server.</span>
    <span class="k">class</span> <span class="nc">server</span> <span class="p">{</span>
      <span class="k">public</span><span class="o">:</span>
        <span class="n">server</span><span class="p">(</span><span class="k">const</span> <span class="n">server</span> <span class="o">&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="k">delete</span><span class="p">;</span>
        <span class="n">server</span> <span class="o">&amp;</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">server</span> <span class="o">&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="k">delete</span><span class="p">;</span>

        <span class="c1">/// Construct the server to listen on the specified TCP address and</span>
        <span class="c1">/// port, and serve up files from the given directory.</span>
        <span class="k">explicit</span> <span class="nf">server</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">address</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">port</span><span class="p">,</span>
                        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">doc_root</span><span class="p">);</span>

        <span class="c1">/// Run the server&#39;s io_context loop.</span>
        <span class="kt">void</span> <span class="nf">run</span><span class="p">();</span>

      <span class="k">private</span><span class="o">:</span>
        <span class="c1">/// Perform an asynchronous accept operation.</span>
        <span class="kt">void</span> <span class="n">do_accept</span><span class="p">();</span>

        <span class="c1">/// Wait for a request to stop the server.</span>
        <span class="kt">void</span> <span class="nf">do_await_stop</span><span class="p">();</span>

        <span class="c1">/// The io_context used to perform asynchronous operations.</span>
        <span class="n">asio</span><span class="o">::</span><span class="n">io_context</span> <span class="n">io_context_</span><span class="p">;</span>

        <span class="c1">/// Executor for the io context</span>
        <span class="n">asio</span><span class="o">::</span><span class="n">thread_pool</span> <span class="n">pool_</span><span class="p">;</span>

        <span class="c1">/// The signal_set is used to register for process termination</span>
        <span class="c1">/// notifications.</span>
        <span class="n">asio</span><span class="o">::</span><span class="n">signal_set</span> <span class="n">signals_</span><span class="p">;</span>

        <span class="c1">/// Acceptor used to listen for incoming connections.</span>
        <span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">acceptor</span> <span class="n">acceptor_</span><span class="p">;</span>

        <span class="c1">/// The connection manager which owns all live connections.</span>
        <span class="n">connection_manager</span> <span class="n">connection_manager_</span><span class="p">;</span>

        <span class="c1">/// The handler for all incoming requests.</span>
        <span class="n">request_handler</span> <span class="n">request_handler_</span><span class="p">;</span>
        <span class="kt">void</span> <span class="nf">setup_signals</span><span class="p">();</span>
        <span class="kt">void</span> <span class="nf">setup_acceptor</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">address</span><span class="p">,</span>
                            <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">port</span><span class="p">);</span>
    <span class="p">};</span>

<span class="p">}</span> <span class="c1">// namespace http::server</span>

<span class="cp">#endif </span><span class="c1">// HTTP_SERVER_HPP</span>
</code></pre></div>
</td></tr></table>
<p>connection_manager.hpp</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">//</span>
<span class="c1">// connection_manager.hpp</span>
<span class="c1">// ~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="c1">//</span>
<span class="c1">// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)</span>
<span class="c1">//</span>
<span class="c1">// Distributed under the Boost Software License, Version 1.0. (See accompanying</span>
<span class="c1">// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)</span>
<span class="c1">//</span>

<span class="cp">#ifndef HTTP_CONNECTION_MANAGER_HPP</span>
<span class="cp">#define HTTP_CONNECTION_MANAGER_HPP</span>

<span class="cp">#include</span> <span class="cpf">&quot;connection.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;set&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">http</span><span class="o">::</span><span class="n">server</span> <span class="p">{</span>

    <span class="c1">/// Manages open connections so that they may be cleanly stopped when</span>
    <span class="c1">/// the server needs to shut down.</span>
    <span class="k">class</span> <span class="nc">connection_manager</span> <span class="p">{</span>
      <span class="k">public</span><span class="o">:</span>
        <span class="n">connection_manager</span><span class="p">(</span><span class="k">const</span> <span class="n">connection_manager</span> <span class="o">&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="k">delete</span><span class="p">;</span>
        <span class="n">connection_manager</span> <span class="o">&amp;</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">connection_manager</span> <span class="o">&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="k">delete</span><span class="p">;</span>

        <span class="c1">/// Construct a connection manager.</span>
        <span class="n">connection_manager</span><span class="p">();</span>

        <span class="c1">/// Add the specified connection to the manager and start it.</span>
        <span class="kt">void</span> <span class="nf">start</span><span class="p">(</span><span class="n">connection_ptr</span> <span class="n">c</span><span class="p">);</span>

        <span class="c1">/// Stop the specified connection.</span>
        <span class="kt">void</span> <span class="nf">stop</span><span class="p">(</span><span class="n">connection_ptr</span> <span class="n">c</span><span class="p">);</span>

        <span class="c1">/// Stop all connections.</span>
        <span class="kt">void</span> <span class="nf">stop_all</span><span class="p">();</span>

      <span class="k">private</span><span class="o">:</span>
        <span class="c1">/// The managed connections.</span>
        <span class="n">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span><span class="n">connection_ptr</span><span class="o">&gt;</span> <span class="n">connections_</span><span class="p">;</span>
    <span class="p">};</span>

<span class="p">}</span> <span class="c1">// namespace http::server</span>

<span class="cp">#endif </span><span class="c1">// HTTP_CONNECTION_MANAGER_HPP</span>
</code></pre></div>
</td></tr></table>
<p>connection.hpp</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">//</span>
<span class="c1">// connection.hpp</span>
<span class="c1">// ~~~~~~~~~~~~~~</span>
<span class="c1">//</span>
<span class="c1">// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)</span>
<span class="c1">//</span>
<span class="c1">// Distributed under the Boost Software License, Version 1.0. (See accompanying</span>
<span class="c1">// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)</span>
<span class="c1">//</span>

<span class="cp">#ifndef HTTP_CONNECTION_HPP</span>
<span class="cp">#define HTTP_CONNECTION_HPP</span>

<span class="cp">#include</span> <span class="cpf">&quot;reply.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;request.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;request_handler.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;request_parser.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;array&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;asio.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;memory&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">http</span><span class="o">::</span><span class="n">server</span> <span class="p">{</span>

    <span class="k">class</span> <span class="nc">connection_manager</span><span class="p">;</span>

    <span class="c1">/// Represents a single connection from a client.</span>
    <span class="k">class</span> <span class="nc">connection</span> <span class="o">:</span> <span class="k">public</span> <span class="n">std</span><span class="o">::</span><span class="n">enable_shared_from_this</span><span class="o">&lt;</span><span class="n">connection</span><span class="o">&gt;</span> <span class="p">{</span>
      <span class="k">public</span><span class="o">:</span>
        <span class="n">connection</span><span class="p">(</span><span class="k">const</span> <span class="n">connection</span> <span class="o">&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="k">delete</span><span class="p">;</span>
        <span class="n">connection</span> <span class="o">&amp;</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">connection</span> <span class="o">&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="k">delete</span><span class="p">;</span>

        <span class="c1">/// Construct a connection with the given socket.</span>
        <span class="k">explicit</span> <span class="nf">connection</span><span class="p">(</span><span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">socket</span> <span class="n">socket</span><span class="p">,</span>
                            <span class="n">connection_manager</span> <span class="o">&amp;</span><span class="n">manager</span><span class="p">,</span>
                            <span class="n">request_handler</span> <span class="o">&amp;</span><span class="n">handler</span><span class="p">);</span>

        <span class="c1">/// Start the first asynchronous operation for the connection.</span>
        <span class="kt">void</span> <span class="nf">start</span><span class="p">();</span>

        <span class="c1">/// Stop all asynchronous operations associated with the connection.</span>
        <span class="kt">void</span> <span class="nf">stop</span><span class="p">();</span>

      <span class="k">private</span><span class="o">:</span>
        <span class="c1">/// Perform an asynchronous read operation.</span>
        <span class="kt">void</span> <span class="n">do_read</span><span class="p">();</span>

        <span class="c1">/// Perform an asynchronous write operation.</span>
        <span class="kt">void</span> <span class="nf">do_write</span><span class="p">();</span>

        <span class="c1">/// Socket for the connection.</span>
        <span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">socket</span> <span class="n">socket_</span><span class="p">;</span>

        <span class="c1">/// The manager for this connection.</span>
        <span class="n">connection_manager</span> <span class="o">&amp;</span><span class="n">connection_manager_</span><span class="p">;</span>

        <span class="c1">/// The handler used to process the incoming request.</span>
        <span class="n">request_handler</span> <span class="o">&amp;</span><span class="n">request_handler_</span><span class="p">;</span>

        <span class="c1">/// Buffer for incoming data.</span>
        <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="mi">8192</span><span class="o">&gt;</span> <span class="n">buffer_</span><span class="p">;</span>

        <span class="c1">/// The incoming request.</span>
        <span class="n">request</span> <span class="n">request_</span><span class="p">;</span>

        <span class="c1">/// The parser for the incoming request.</span>
        <span class="n">request_parser</span> <span class="n">request_parser_</span><span class="p">;</span>

        <span class="c1">/// The reply to be sent back to the client.</span>
        <span class="n">reply</span> <span class="n">reply_</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">typedef</span> <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">connection</span><span class="o">&gt;</span> <span class="n">connection_ptr</span><span class="p">;</span>

<span class="p">}</span> <span class="c1">// namespace http::server</span>

<span class="cp">#endif </span><span class="c1">// HTTP_CONNECTION_HPP</span>
</code></pre></div>
</td></tr></table>
<p>header.hpp</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">//</span>
<span class="c1">// header.hpp</span>
<span class="c1">// ~~~~~~~~~~</span>
<span class="c1">//</span>
<span class="c1">// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)</span>
<span class="c1">//</span>
<span class="c1">// Distributed under the Boost Software License, Version 1.0. (See accompanying</span>
<span class="c1">// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)</span>
<span class="c1">//</span>

<span class="cp">#ifndef HTTP_HEADER_HPP</span>
<span class="cp">#define HTTP_HEADER_HPP</span>

<span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">http</span><span class="o">::</span><span class="n">server</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="nc">header</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">value</span><span class="p">;</span>
    <span class="p">};</span>
<span class="p">}</span> <span class="c1">// namespace http::server</span>

<span class="cp">#endif </span><span class="c1">// HTTP_HEADER_HPP</span>
</code></pre></div>
</td></tr></table>
<p>reply.hpp</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">//</span>
<span class="c1">// reply.hpp</span>
<span class="c1">// ~~~~~~~~~</span>
<span class="c1">//</span>
<span class="c1">// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)</span>
<span class="c1">//</span>
<span class="c1">// Distributed under the Boost Software License, Version 1.0. (See accompanying</span>
<span class="c1">// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)</span>
<span class="c1">//</span>

<span class="cp">#ifndef HTTP_REPLY_HPP</span>
<span class="cp">#define HTTP_REPLY_HPP</span>

<span class="cp">#include</span> <span class="cpf">&quot;header.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;asio.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">http</span><span class="o">::</span><span class="n">server</span> <span class="p">{</span>

    <span class="c1">/// A reply to be sent to a client.</span>
    <span class="k">struct</span> <span class="nc">reply</span> <span class="p">{</span>
        <span class="c1">/// The status of the reply.</span>
        <span class="k">enum</span> <span class="nc">status_type</span> <span class="p">{</span>
            <span class="n">ok</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span>
            <span class="n">created</span> <span class="o">=</span> <span class="mi">201</span><span class="p">,</span>
            <span class="n">accepted</span> <span class="o">=</span> <span class="mi">202</span><span class="p">,</span>
            <span class="n">no_content</span> <span class="o">=</span> <span class="mi">204</span><span class="p">,</span>
            <span class="n">multiple_choices</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
            <span class="n">moved_permanently</span> <span class="o">=</span> <span class="mi">301</span><span class="p">,</span>
            <span class="n">moved_temporarily</span> <span class="o">=</span> <span class="mi">302</span><span class="p">,</span>
            <span class="n">not_modified</span> <span class="o">=</span> <span class="mi">304</span><span class="p">,</span>
            <span class="n">bad_request</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span>
            <span class="n">unauthorized</span> <span class="o">=</span> <span class="mi">401</span><span class="p">,</span>
            <span class="n">forbidden</span> <span class="o">=</span> <span class="mi">403</span><span class="p">,</span>
            <span class="n">not_found</span> <span class="o">=</span> <span class="mi">404</span><span class="p">,</span>
            <span class="n">internal_server_error</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
            <span class="n">not_implemented</span> <span class="o">=</span> <span class="mi">501</span><span class="p">,</span>
            <span class="n">bad_gateway</span> <span class="o">=</span> <span class="mi">502</span><span class="p">,</span>
            <span class="n">service_unavailable</span> <span class="o">=</span> <span class="mi">503</span>
        <span class="p">}</span> <span class="n">status</span><span class="p">;</span>

        <span class="c1">/// The headers to be included in the reply.</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">header</span><span class="o">&gt;</span> <span class="n">headers</span><span class="p">;</span>

        <span class="c1">/// The content to be sent in the reply.</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">content</span><span class="p">;</span>

        <span class="c1">/// Convert the reply into a vector of buffers. The buffers do not</span>
        <span class="c1">/// own the underlying memory blocks, therefore the reply object</span>
        <span class="c1">/// must remain valid and not be changed until the write operation</span>
        <span class="c1">/// has completed.</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">asio</span><span class="o">::</span><span class="n">const_buffer</span><span class="o">&gt;</span> <span class="n">to_buffers</span><span class="p">();</span>

        <span class="c1">/// Get a stock reply.</span>
        <span class="k">static</span> <span class="n">reply</span> <span class="n">stock_reply</span><span class="p">(</span><span class="n">status_type</span> <span class="n">status</span><span class="p">);</span>
    <span class="p">};</span>

<span class="p">}</span> <span class="c1">// namespace http::server</span>

<span class="cp">#endif </span><span class="c1">// HTTP_REPLY_HPP</span>
</code></pre></div>
</td></tr></table>
<p>request.hpp</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">//</span>
<span class="c1">// request.hpp</span>
<span class="c1">// ~~~~~~~~~~~</span>
<span class="c1">//</span>
<span class="c1">// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)</span>
<span class="c1">//</span>
<span class="c1">// Distributed under the Boost Software License, Version 1.0. (See accompanying</span>
<span class="c1">// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)</span>
<span class="c1">//</span>

<span class="cp">#ifndef HTTP_REQUEST_HPP</span>
<span class="cp">#define HTTP_REQUEST_HPP</span>

<span class="cp">#include</span> <span class="cpf">&quot;header.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">http</span><span class="o">::</span><span class="n">server</span> <span class="p">{</span>
    <span class="c1">/// A request received from a client.</span>
    <span class="k">struct</span> <span class="nc">request</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">method</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">uri</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">http_version_major</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">http_version_minor</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">header</span><span class="o">&gt;</span> <span class="n">headers</span><span class="p">;</span>
    <span class="p">};</span>
<span class="p">}</span> <span class="c1">// namespace http::server</span>

<span class="cp">#endif </span><span class="c1">// HTTP_REQUEST_HPP</span>
</code></pre></div>
</td></tr></table>
<p>request_parser.hpp</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">//</span>
<span class="c1">// request_parser.hpp</span>
<span class="c1">// ~~~~~~~~~~~~~~~~~~</span>
<span class="c1">//</span>
<span class="c1">// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)</span>
<span class="c1">//</span>
<span class="c1">// Distributed under the Boost Software License, Version 1.0. (See accompanying</span>
<span class="c1">// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)</span>
<span class="c1">//</span>

<span class="cp">#ifndef HTTP_REQUEST_PARSER_HPP</span>
<span class="cp">#define HTTP_REQUEST_PARSER_HPP</span>

<span class="cp">#include</span> <span class="cpf">&lt;tuple&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">http</span><span class="o">::</span><span class="n">server</span> <span class="p">{</span>

    <span class="k">struct</span> <span class="nc">request</span><span class="p">;</span>

    <span class="c1">/// Parser for incoming requests.</span>
    <span class="k">class</span> <span class="nc">request_parser</span> <span class="p">{</span>
      <span class="k">public</span><span class="o">:</span>
        <span class="c1">/// Construct ready to parse the request method.</span>
        <span class="n">request_parser</span><span class="p">();</span>

        <span class="c1">/// Reset to initial parser state.</span>
        <span class="kt">void</span> <span class="nf">reset</span><span class="p">();</span>

        <span class="c1">/// Result of parse.</span>
        <span class="k">enum</span> <span class="nc">result_type</span> <span class="p">{</span> <span class="n">good</span><span class="p">,</span> <span class="n">bad</span><span class="p">,</span> <span class="n">indeterminate</span> <span class="p">};</span>

        <span class="c1">/// Parse some data. The enum return value is good when a complete</span>
        <span class="c1">/// request has been parsed, bad if the data is invalid,</span>
        <span class="c1">/// indeterminate when more data is required. The InputIterator</span>
        <span class="c1">/// return value indicates how much of the input has been consumed.</span>
        <span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">InputIterator</span><span class="o">&gt;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">tuple</span><span class="o">&lt;</span><span class="n">result_type</span><span class="p">,</span> <span class="n">InputIterator</span><span class="o">&gt;</span>
        <span class="n">parse</span><span class="p">(</span><span class="n">request</span> <span class="o">&amp;</span><span class="n">req</span><span class="p">,</span> <span class="n">InputIterator</span> <span class="n">begin</span><span class="p">,</span> <span class="n">InputIterator</span> <span class="n">end</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">begin</span> <span class="o">!=</span> <span class="n">end</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">result_type</span> <span class="n">result</span> <span class="o">=</span> <span class="n">consume</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="o">*</span><span class="n">begin</span><span class="o">++</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="n">good</span> <span class="o">||</span> <span class="n">result</span> <span class="o">==</span> <span class="n">bad</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">make_tuple</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">begin</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">make_tuple</span><span class="p">(</span><span class="n">indeterminate</span><span class="p">,</span> <span class="n">begin</span><span class="p">);</span>
        <span class="p">}</span>

      <span class="k">private</span><span class="o">:</span>
        <span class="c1">/// Handle the next character of input.</span>
        <span class="n">result_type</span> <span class="n">consume</span><span class="p">(</span><span class="n">request</span> <span class="o">&amp;</span><span class="n">req</span><span class="p">,</span> <span class="kt">char</span> <span class="n">input</span><span class="p">);</span>

        <span class="c1">/// Check if a byte is an HTTP character.</span>
        <span class="k">static</span> <span class="kt">bool</span> <span class="n">is_char</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">);</span>

        <span class="c1">/// Check if a byte is an HTTP control character.</span>
        <span class="k">static</span> <span class="kt">bool</span> <span class="n">is_ctl</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">);</span>

        <span class="c1">/// Check if a byte is defined as an HTTP tspecial character.</span>
        <span class="k">static</span> <span class="kt">bool</span> <span class="n">is_tspecial</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">);</span>

        <span class="c1">/// Check if a byte is a digit.</span>
        <span class="k">static</span> <span class="kt">bool</span> <span class="n">is_digit</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">);</span>

        <span class="c1">/// The current state of the parser.</span>
        <span class="k">enum</span> <span class="nc">state</span> <span class="p">{</span>
            <span class="n">method_start</span><span class="p">,</span>
            <span class="n">method</span><span class="p">,</span>
            <span class="n">uri</span><span class="p">,</span>
            <span class="n">http_version_h</span><span class="p">,</span>
            <span class="n">http_version_t_1</span><span class="p">,</span>
            <span class="n">http_version_t_2</span><span class="p">,</span>
            <span class="n">http_version_p</span><span class="p">,</span>
            <span class="n">http_version_slash</span><span class="p">,</span>
            <span class="n">http_version_major_start</span><span class="p">,</span>
            <span class="n">http_version_major</span><span class="p">,</span>
            <span class="n">http_version_minor_start</span><span class="p">,</span>
            <span class="n">http_version_minor</span><span class="p">,</span>
            <span class="n">expecting_newline_1</span><span class="p">,</span>
            <span class="n">header_line_start</span><span class="p">,</span>
            <span class="n">header_lws</span><span class="p">,</span>
            <span class="n">header_name</span><span class="p">,</span>
            <span class="n">space_before_header_value</span><span class="p">,</span>
            <span class="n">header_value</span><span class="p">,</span>
            <span class="n">expecting_newline_2</span><span class="p">,</span>
            <span class="n">expecting_newline_3</span>
        <span class="p">}</span> <span class="n">state_</span><span class="p">;</span>
    <span class="p">};</span>

<span class="p">}</span> <span class="c1">// namespace http::server</span>

<span class="cp">#endif </span><span class="c1">// HTTP_REQUEST_PARSER_HPP</span>
</code></pre></div>
</td></tr></table>
<p>mime_types.hpp</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">//</span>
<span class="c1">// mime_types.hpp</span>
<span class="c1">// ~~~~~~~~~~~~~~</span>
<span class="c1">//</span>
<span class="c1">// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)</span>
<span class="c1">//</span>
<span class="c1">// Distributed under the Boost Software License, Version 1.0. (See accompanying</span>
<span class="c1">// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)</span>
<span class="c1">//</span>

<span class="cp">#ifndef HTTP_MIME_TYPES_HPP</span>
<span class="cp">#define HTTP_MIME_TYPES_HPP</span>

<span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">http</span><span class="o">::</span><span class="n">server</span><span class="o">::</span><span class="n">mime_types</span> <span class="p">{</span>

    <span class="c1">/// Convert a file extension into a MIME type.</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">extension_to_type</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">extension</span><span class="p">);</span>

<span class="p">}</span> <span class="c1">// namespace http::server::mime_types</span>

<span class="cp">#endif </span><span class="c1">// HTTP_MIME_TYPES_HPP</span>
</code></pre></div>
</td></tr></table>
<p>request_handler.hpp</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">//</span>
<span class="c1">// request_handler.hpp</span>
<span class="c1">// ~~~~~~~~~~~~~~~~~~~</span>
<span class="c1">//</span>
<span class="c1">// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)</span>
<span class="c1">//</span>
<span class="c1">// Distributed under the Boost Software License, Version 1.0. (See accompanying</span>
<span class="c1">// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)</span>
<span class="c1">//</span>

<span class="cp">#ifndef HTTP_REQUEST_HANDLER_HPP</span>
<span class="cp">#define HTTP_REQUEST_HANDLER_HPP</span>

<span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">http</span><span class="o">::</span><span class="n">server</span> <span class="p">{</span>

    <span class="k">struct</span> <span class="nc">reply</span><span class="p">;</span>
    <span class="k">struct</span> <span class="nc">request</span><span class="p">;</span>

    <span class="c1">/// The common handler for all incoming requests.</span>
    <span class="k">class</span> <span class="nc">request_handler</span> <span class="p">{</span>
      <span class="k">public</span><span class="o">:</span>
        <span class="n">request_handler</span><span class="p">(</span><span class="k">const</span> <span class="n">request_handler</span> <span class="o">&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="k">delete</span><span class="p">;</span>
        <span class="n">request_handler</span> <span class="o">&amp;</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">request_handler</span> <span class="o">&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="k">delete</span><span class="p">;</span>

        <span class="c1">/// Construct with a directory containing files to be served.</span>
        <span class="k">explicit</span> <span class="nf">request_handler</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">doc_root</span><span class="p">);</span>

        <span class="c1">/// Handle a request and produce a reply.</span>
        <span class="kt">void</span> <span class="nf">handle_request</span><span class="p">(</span><span class="k">const</span> <span class="n">request</span> <span class="o">&amp;</span><span class="n">req</span><span class="p">,</span> <span class="n">reply</span> <span class="o">&amp;</span><span class="n">rep</span><span class="p">);</span>

      <span class="k">private</span><span class="o">:</span>
        <span class="c1">/// The directory containing the files to be served.</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">doc_root_</span><span class="p">;</span>

        <span class="c1">/// Perform URL-decoding on a string. Returns false if the encoding</span>
        <span class="c1">/// was invalid.</span>
        <span class="k">static</span> <span class="kt">bool</span> <span class="n">url_decode</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">in</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">out</span><span class="p">);</span>
    <span class="p">};</span>

<span class="p">}</span> <span class="c1">// namespace http::server</span>

<span class="cp">#endif </span><span class="c1">// HTTP_REQUEST_HANDLER_HPP</span>
</code></pre></div>
</td></tr></table>
<p>mime_types.cpp</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">//</span>
<span class="c1">// mime_types.cpp</span>
<span class="c1">// ~~~~~~~~~~~~~~</span>
<span class="c1">//</span>
<span class="c1">// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)</span>
<span class="c1">//</span>
<span class="c1">// Distributed under the Boost Software License, Version 1.0. (See accompanying</span>
<span class="c1">// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)</span>
<span class="c1">//</span>

<span class="cp">#include</span> <span class="cpf">&quot;mime_types.hpp&quot;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">http</span><span class="o">::</span><span class="n">server</span><span class="o">::</span><span class="n">mime_types</span> <span class="p">{</span>

    <span class="k">constexpr</span> <span class="k">struct</span> <span class="nc">mapping</span> <span class="p">{</span>
        <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extension</span><span class="p">;</span>
        <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">mime_type</span><span class="p">;</span>
    <span class="p">}</span> <span class="n">mappings</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{{</span><span class="s">&quot;gif&quot;</span><span class="p">,</span> <span class="s">&quot;image/gif&quot;</span><span class="p">},</span>
                    <span class="p">{</span><span class="s">&quot;htm&quot;</span><span class="p">,</span> <span class="s">&quot;text/html&quot;</span><span class="p">},</span>
                    <span class="p">{</span><span class="s">&quot;html&quot;</span><span class="p">,</span> <span class="s">&quot;text/html&quot;</span><span class="p">},</span>
                    <span class="p">{</span><span class="s">&quot;jpg&quot;</span><span class="p">,</span> <span class="s">&quot;image/jpeg&quot;</span><span class="p">},</span>
                    <span class="p">{</span><span class="s">&quot;png&quot;</span><span class="p">,</span> <span class="s">&quot;image/png&quot;</span><span class="p">}};</span>

    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">extension_to_type</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">extension</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">mapping</span> <span class="nl">m</span> <span class="p">:</span> <span class="n">mappings</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">extension</span> <span class="o">==</span> <span class="n">extension</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">m</span><span class="p">.</span><span class="n">mime_type</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="s">&quot;text/plain&quot;</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span> <span class="c1">// namespace http::server::mime_types</span>
</code></pre></div>
</td></tr></table>
<p>request_parser.cpp</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">//</span>
<span class="c1">// request_parser.cpp</span>
<span class="c1">// ~~~~~~~~~~~~~~~~~~</span>
<span class="c1">//</span>
<span class="c1">// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)</span>
<span class="c1">//</span>
<span class="c1">// Distributed under the Boost Software License, Version 1.0. (See accompanying</span>
<span class="c1">// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)</span>
<span class="c1">//</span>

<span class="cp">#include</span> <span class="cpf">&quot;request_parser.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;request.hpp&quot;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">http</span><span class="o">::</span><span class="n">server</span> <span class="p">{</span>

    <span class="n">request_parser</span><span class="o">::</span><span class="n">request_parser</span><span class="p">()</span> <span class="o">:</span> <span class="n">state_</span><span class="p">(</span><span class="n">method_start</span><span class="p">)</span> <span class="p">{}</span>

    <span class="kt">void</span> <span class="n">request_parser</span><span class="o">::</span><span class="n">reset</span><span class="p">()</span> <span class="p">{</span> <span class="n">state_</span> <span class="o">=</span> <span class="n">method_start</span><span class="p">;</span> <span class="p">}</span>

    <span class="n">request_parser</span><span class="o">::</span><span class="n">result_type</span> <span class="n">request_parser</span><span class="o">::</span><span class="n">consume</span><span class="p">(</span><span class="n">request</span> <span class="o">&amp;</span><span class="n">req</span><span class="p">,</span>
                                                        <span class="kt">char</span> <span class="n">input</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="p">(</span><span class="n">state_</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="nl">method_start</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">is_char</span><span class="p">(</span><span class="n">input</span><span class="p">)</span> <span class="o">||</span> <span class="n">is_ctl</span><span class="p">(</span><span class="n">input</span><span class="p">)</span> <span class="o">||</span> <span class="n">is_tspecial</span><span class="p">(</span><span class="n">input</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">method</span><span class="p">;</span>
                <span class="n">req</span><span class="p">.</span><span class="n">method</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">method</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39; &#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">uri</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">is_char</span><span class="p">(</span><span class="n">input</span><span class="p">)</span> <span class="o">||</span> <span class="n">is_ctl</span><span class="p">(</span><span class="n">input</span><span class="p">)</span> <span class="o">||</span> <span class="n">is_tspecial</span><span class="p">(</span><span class="n">input</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">req</span><span class="p">.</span><span class="n">method</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">uri</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39; &#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">http_version_h</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">is_ctl</span><span class="p">(</span><span class="n">input</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">req</span><span class="p">.</span><span class="n">uri</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">http_version_h</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39;H&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">http_version_t_1</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">http_version_t_1</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39;T&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">http_version_t_2</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">http_version_t_2</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39;T&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">http_version_p</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">http_version_p</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39;P&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">http_version_slash</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">http_version_slash</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39;/&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">req</span><span class="p">.</span><span class="n">http_version_major</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="n">req</span><span class="p">.</span><span class="n">http_version_minor</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">http_version_major_start</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">http_version_major_start</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">is_digit</span><span class="p">(</span><span class="n">input</span><span class="p">))</span> <span class="p">{</span>
                <span class="n">req</span><span class="p">.</span><span class="n">http_version_major</span> <span class="o">=</span>
                    <span class="n">req</span><span class="p">.</span><span class="n">http_version_major</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">input</span> <span class="o">-</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">http_version_major</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">http_version_major</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39;.&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">http_version_minor_start</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">is_digit</span><span class="p">(</span><span class="n">input</span><span class="p">))</span> <span class="p">{</span>
                <span class="n">req</span><span class="p">.</span><span class="n">http_version_major</span> <span class="o">=</span>
                    <span class="n">req</span><span class="p">.</span><span class="n">http_version_major</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">input</span> <span class="o">-</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">http_version_minor_start</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">is_digit</span><span class="p">(</span><span class="n">input</span><span class="p">))</span> <span class="p">{</span>
                <span class="n">req</span><span class="p">.</span><span class="n">http_version_minor</span> <span class="o">=</span>
                    <span class="n">req</span><span class="p">.</span><span class="n">http_version_minor</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">input</span> <span class="o">-</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">http_version_minor</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">http_version_minor</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39;\r&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">expecting_newline_1</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">is_digit</span><span class="p">(</span><span class="n">input</span><span class="p">))</span> <span class="p">{</span>
                <span class="n">req</span><span class="p">.</span><span class="n">http_version_minor</span> <span class="o">=</span>
                    <span class="n">req</span><span class="p">.</span><span class="n">http_version_minor</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">input</span> <span class="o">-</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">expecting_newline_1</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">header_line_start</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">header_line_start</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39;\r&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">expecting_newline_3</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">req</span><span class="p">.</span><span class="n">headers</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">&amp;&amp;</span>
                       <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39; &#39;</span> <span class="o">||</span> <span class="n">input</span> <span class="o">==</span> <span class="sc">&#39;\t&#39;</span><span class="p">))</span> <span class="p">{</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">header_lws</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">is_char</span><span class="p">(</span><span class="n">input</span><span class="p">)</span> <span class="o">||</span> <span class="n">is_ctl</span><span class="p">(</span><span class="n">input</span><span class="p">)</span> <span class="o">||</span> <span class="n">is_tspecial</span><span class="p">(</span><span class="n">input</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">req</span><span class="p">.</span><span class="n">headers</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">header</span><span class="p">());</span>
                <span class="n">req</span><span class="p">.</span><span class="n">headers</span><span class="p">.</span><span class="n">back</span><span class="p">().</span><span class="n">name</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">header_name</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">header_lws</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39;\r&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">expecting_newline_2</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39; &#39;</span> <span class="o">||</span> <span class="n">input</span> <span class="o">==</span> <span class="sc">&#39;\t&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">is_ctl</span><span class="p">(</span><span class="n">input</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">header_value</span><span class="p">;</span>
                <span class="n">req</span><span class="p">.</span><span class="n">headers</span><span class="p">.</span><span class="n">back</span><span class="p">().</span><span class="n">value</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">header_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39;:&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">space_before_header_value</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">is_char</span><span class="p">(</span><span class="n">input</span><span class="p">)</span> <span class="o">||</span> <span class="n">is_ctl</span><span class="p">(</span><span class="n">input</span><span class="p">)</span> <span class="o">||</span> <span class="n">is_tspecial</span><span class="p">(</span><span class="n">input</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">req</span><span class="p">.</span><span class="n">headers</span><span class="p">.</span><span class="n">back</span><span class="p">().</span><span class="n">name</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">space_before_header_value</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39; &#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">header_value</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">header_value</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39;\r&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">expecting_newline_2</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">is_ctl</span><span class="p">(</span><span class="n">input</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">req</span><span class="p">.</span><span class="n">headers</span><span class="p">.</span><span class="n">back</span><span class="p">().</span><span class="n">value</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">expecting_newline_2</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">state_</span> <span class="o">=</span> <span class="n">header_line_start</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">indeterminate</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="nl">expecting_newline_3</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">input</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="nl">good</span> <span class="p">:</span> <span class="n">bad</span><span class="p">;</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">return</span> <span class="n">bad</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kt">bool</span> <span class="n">request_parser</span><span class="o">::</span><span class="n">is_char</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">c</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="mi">127</span><span class="p">;</span> <span class="p">}</span>

    <span class="kt">bool</span> <span class="n">request_parser</span><span class="o">::</span><span class="n">is_ctl</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="mi">31</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="mi">127</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">bool</span> <span class="n">request_parser</span><span class="o">::</span><span class="n">is_tspecial</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="sc">&#39;(&#39;</span><span class="o">:</span>
        <span class="k">case</span> <span class="sc">&#39;)&#39;</span><span class="o">:</span>
        <span class="k">case</span> <span class="sc">&#39;&lt;&#39;</span><span class="o">:</span>
        <span class="k">case</span> <span class="sc">&#39;&gt;&#39;</span><span class="o">:</span>
        <span class="k">case</span> <span class="sc">&#39;@&#39;</span><span class="o">:</span>
        <span class="k">case</span> <span class="sc">&#39;,&#39;</span><span class="o">:</span>
        <span class="k">case</span> <span class="sc">&#39;;&#39;</span><span class="o">:</span>
        <span class="k">case</span> <span class="sc">&#39;:&#39;</span><span class="o">:</span>
        <span class="k">case</span> <span class="sc">&#39;\\&#39;</span><span class="o">:</span>
        <span class="k">case</span> <span class="sc">&#39;&quot;&#39;</span><span class="o">:</span>
        <span class="k">case</span> <span class="sc">&#39;/&#39;</span><span class="o">:</span>
        <span class="k">case</span> <span class="sc">&#39;[&#39;</span><span class="o">:</span>
        <span class="k">case</span> <span class="sc">&#39;]&#39;</span><span class="o">:</span>
        <span class="k">case</span> <span class="sc">&#39;?&#39;</span><span class="o">:</span>
        <span class="k">case</span> <span class="sc">&#39;=&#39;</span><span class="o">:</span>
        <span class="k">case</span> <span class="sc">&#39;{&#39;</span><span class="o">:</span>
        <span class="k">case</span> <span class="sc">&#39;}&#39;</span><span class="o">:</span>
        <span class="k">case</span> <span class="sc">&#39; &#39;</span><span class="o">:</span>
        <span class="k">case</span> <span class="sc">&#39;\t&#39;</span><span class="o">:</span>
            <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kt">bool</span> <span class="n">request_parser</span><span class="o">::</span><span class="n">is_digit</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">c</span> <span class="o">&gt;=</span> <span class="sc">&#39;0&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="sc">&#39;9&#39;</span><span class="p">;</span> <span class="p">}</span>

<span class="p">}</span> <span class="c1">// namespace http::server</span>
</code></pre></div>
</td></tr></table>
<p>reply.cpp</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">//</span>
<span class="c1">// reply.cpp</span>
<span class="c1">// ~~~~~~~~~</span>
<span class="c1">//</span>
<span class="c1">// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)</span>
<span class="c1">//</span>
<span class="c1">// Distributed under the Boost Software License, Version 1.0. (See accompanying</span>
<span class="c1">// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)</span>
<span class="c1">//</span>

<span class="cp">#include</span> <span class="cpf">&quot;reply.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">http</span><span class="o">::</span><span class="n">server</span> <span class="p">{</span>

    <span class="k">namespace</span> <span class="n">status_strings</span> <span class="p">{</span>

        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">ok</span> <span class="o">=</span> <span class="s">&quot;HTTP/1.0 200 OK</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>
        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">created</span> <span class="o">=</span> <span class="s">&quot;HTTP/1.0 201 Created</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>
        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">accepted</span> <span class="o">=</span> <span class="s">&quot;HTTP/1.0 202 Accepted</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>
        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">no_content</span> <span class="o">=</span> <span class="s">&quot;HTTP/1.0 204 No Content</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>
        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">multiple_choices</span> <span class="o">=</span>
            <span class="s">&quot;HTTP/1.0 300 Multiple Choices</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>
        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">moved_permanently</span> <span class="o">=</span>
            <span class="s">&quot;HTTP/1.0 301 Moved Permanently</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>
        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">moved_temporarily</span> <span class="o">=</span>
            <span class="s">&quot;HTTP/1.0 302 Moved Temporarily</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>
        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">not_modified</span> <span class="o">=</span> <span class="s">&quot;HTTP/1.0 304 Not Modified</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>
        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">bad_request</span> <span class="o">=</span> <span class="s">&quot;HTTP/1.0 400 Bad Request</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>
        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">unauthorized</span> <span class="o">=</span> <span class="s">&quot;HTTP/1.0 401 Unauthorized</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>
        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">forbidden</span> <span class="o">=</span> <span class="s">&quot;HTTP/1.0 403 Forbidden</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>
        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">not_found</span> <span class="o">=</span> <span class="s">&quot;HTTP/1.0 404 Not Found</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>
        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">internal_server_error</span> <span class="o">=</span>
            <span class="s">&quot;HTTP/1.0 500 Internal Server Error</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>
        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">not_implemented</span> <span class="o">=</span> <span class="s">&quot;HTTP/1.0 501 Not Implemented</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>
        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">bad_gateway</span> <span class="o">=</span> <span class="s">&quot;HTTP/1.0 502 Bad Gateway</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>
        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">service_unavailable</span> <span class="o">=</span>
            <span class="s">&quot;HTTP/1.0 503 Service Unavailable</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>

        <span class="n">asio</span><span class="o">::</span><span class="n">const_buffer</span> <span class="n">to_buffer</span><span class="p">(</span><span class="n">reply</span><span class="o">::</span><span class="n">status_type</span> <span class="n">status</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">switch</span> <span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">ok</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">ok</span><span class="p">);</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">created</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">created</span><span class="p">);</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">accepted</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">accepted</span><span class="p">);</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">no_content</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">no_content</span><span class="p">);</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">multiple_choices</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">multiple_choices</span><span class="p">);</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">moved_permanently</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">moved_permanently</span><span class="p">);</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">moved_temporarily</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">moved_temporarily</span><span class="p">);</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">not_modified</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">not_modified</span><span class="p">);</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">bad_request</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">bad_request</span><span class="p">);</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">unauthorized</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">unauthorized</span><span class="p">);</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">forbidden</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">forbidden</span><span class="p">);</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">not_found</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">not_found</span><span class="p">);</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">internal_server_error</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">internal_server_error</span><span class="p">);</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">not_implemented</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">not_implemented</span><span class="p">);</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">bad_gateway</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">bad_gateway</span><span class="p">);</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">service_unavailable</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">service_unavailable</span><span class="p">);</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">internal_server_error</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span> <span class="c1">// namespace status_strings</span>

    <span class="k">namespace</span> <span class="n">misc_strings</span> <span class="p">{</span>

        <span class="k">const</span> <span class="kt">char</span> <span class="n">name_value_separator</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="sc">&#39;:&#39;</span><span class="p">,</span> <span class="sc">&#39; &#39;</span><span class="p">};</span>
        <span class="k">const</span> <span class="kt">char</span> <span class="n">crlf</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="sc">&#39;\r&#39;</span><span class="p">,</span> <span class="sc">&#39;\n&#39;</span><span class="p">};</span>

    <span class="p">}</span> <span class="c1">// namespace misc_strings</span>

    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">asio</span><span class="o">::</span><span class="n">const_buffer</span><span class="o">&gt;</span> <span class="n">reply</span><span class="o">::</span><span class="n">to_buffers</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">asio</span><span class="o">::</span><span class="n">const_buffer</span><span class="o">&gt;</span> <span class="n">buffers</span><span class="p">;</span>
        <span class="n">buffers</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">status_strings</span><span class="o">::</span><span class="n">to_buffer</span><span class="p">(</span><span class="n">status</span><span class="p">));</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">headers</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">header</span> <span class="o">&amp;</span><span class="n">h</span> <span class="o">=</span> <span class="n">headers</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="n">buffers</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="n">name</span><span class="p">));</span>
            <span class="n">buffers</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">misc_strings</span><span class="o">::</span><span class="n">name_value_separator</span><span class="p">));</span>
            <span class="n">buffers</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="n">value</span><span class="p">));</span>
            <span class="n">buffers</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">misc_strings</span><span class="o">::</span><span class="n">crlf</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="n">buffers</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">misc_strings</span><span class="o">::</span><span class="n">crlf</span><span class="p">));</span>
        <span class="n">buffers</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">content</span><span class="p">));</span>
        <span class="k">return</span> <span class="n">buffers</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">namespace</span> <span class="n">stock_replies</span> <span class="p">{</span>

        <span class="k">namespace</span> <span class="n">as_string</span> <span class="p">{</span>
            <span class="k">constexpr</span> <span class="kt">char</span> <span class="n">ok</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
            <span class="k">constexpr</span> <span class="kt">char</span> <span class="n">created</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;&lt;html&gt;&quot;</span>
                                       <span class="s">&quot;&lt;head&gt;&lt;title&gt;Created&lt;/title&gt;&lt;/head&gt;&quot;</span>
                                       <span class="s">&quot;&lt;body&gt;&lt;h1&gt;201 Created&lt;/h1&gt;&lt;/body&gt;&quot;</span>
                                       <span class="s">&quot;&lt;/html&gt;&quot;</span><span class="p">;</span>
            <span class="k">constexpr</span> <span class="kt">char</span> <span class="n">accepted</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;&lt;html&gt;&quot;</span>
                                        <span class="s">&quot;&lt;head&gt;&lt;title&gt;Accepted&lt;/title&gt;&lt;/head&gt;&quot;</span>
                                        <span class="s">&quot;&lt;body&gt;&lt;h1&gt;202 Accepted&lt;/h1&gt;&lt;/body&gt;&quot;</span>
                                        <span class="s">&quot;&lt;/html&gt;&quot;</span><span class="p">;</span>
            <span class="k">constexpr</span> <span class="kt">char</span> <span class="n">no_content</span><span class="p">[]</span> <span class="o">=</span>
                <span class="s">&quot;&lt;html&gt;&quot;</span>
                <span class="s">&quot;&lt;head&gt;&lt;title&gt;No Content&lt;/title&gt;&lt;/head&gt;&quot;</span>
                <span class="s">&quot;&lt;body&gt;&lt;h1&gt;204 Content&lt;/h1&gt;&lt;/body&gt;&quot;</span>
                <span class="s">&quot;&lt;/html&gt;&quot;</span><span class="p">;</span>
            <span class="k">constexpr</span> <span class="kt">char</span> <span class="n">multiple_choices</span><span class="p">[]</span> <span class="o">=</span>
                <span class="s">&quot;&lt;html&gt;&quot;</span>
                <span class="s">&quot;&lt;head&gt;&lt;title&gt;Multiple Choices&lt;/title&gt;&lt;/head&gt;&quot;</span>
                <span class="s">&quot;&lt;body&gt;&lt;h1&gt;300 Multiple Choices&lt;/h1&gt;&lt;/body&gt;&quot;</span>
                <span class="s">&quot;&lt;/html&gt;&quot;</span><span class="p">;</span>
            <span class="k">constexpr</span> <span class="kt">char</span> <span class="n">moved_permanently</span><span class="p">[]</span> <span class="o">=</span>
                <span class="s">&quot;&lt;html&gt;&quot;</span>
                <span class="s">&quot;&lt;head&gt;&lt;title&gt;Moved Permanently&lt;/title&gt;&lt;/head&gt;&quot;</span>
                <span class="s">&quot;&lt;body&gt;&lt;h1&gt;301 Moved Permanently&lt;/h1&gt;&lt;/body&gt;&quot;</span>
                <span class="s">&quot;&lt;/html&gt;&quot;</span><span class="p">;</span>
            <span class="k">constexpr</span> <span class="kt">char</span> <span class="n">moved_temporarily</span><span class="p">[]</span> <span class="o">=</span>
                <span class="s">&quot;&lt;html&gt;&quot;</span>
                <span class="s">&quot;&lt;head&gt;&lt;title&gt;Moved Temporarily&lt;/title&gt;&lt;/head&gt;&quot;</span>
                <span class="s">&quot;&lt;body&gt;&lt;h1&gt;302 Moved Temporarily&lt;/h1&gt;&lt;/body&gt;&quot;</span>
                <span class="s">&quot;&lt;/html&gt;&quot;</span><span class="p">;</span>
            <span class="k">constexpr</span> <span class="kt">char</span> <span class="n">not_modified</span><span class="p">[]</span> <span class="o">=</span>
                <span class="s">&quot;&lt;html&gt;&quot;</span>
                <span class="s">&quot;&lt;head&gt;&lt;title&gt;Not Modified&lt;/title&gt;&lt;/head&gt;&quot;</span>
                <span class="s">&quot;&lt;body&gt;&lt;h1&gt;304 Not Modified&lt;/h1&gt;&lt;/body&gt;&quot;</span>
                <span class="s">&quot;&lt;/html&gt;&quot;</span><span class="p">;</span>
            <span class="k">constexpr</span> <span class="kt">char</span> <span class="n">bad_request</span><span class="p">[]</span> <span class="o">=</span>
                <span class="s">&quot;&lt;html&gt;&quot;</span>
                <span class="s">&quot;&lt;head&gt;&lt;title&gt;Bad Request&lt;/title&gt;&lt;/head&gt;&quot;</span>
                <span class="s">&quot;&lt;body&gt;&lt;h1&gt;400 Bad Request&lt;/h1&gt;&lt;/body&gt;&quot;</span>
                <span class="s">&quot;&lt;/html&gt;&quot;</span><span class="p">;</span>
            <span class="k">constexpr</span> <span class="kt">char</span> <span class="n">unauthorized</span><span class="p">[]</span> <span class="o">=</span>
                <span class="s">&quot;&lt;html&gt;&quot;</span>
                <span class="s">&quot;&lt;head&gt;&lt;title&gt;Unauthorized&lt;/title&gt;&lt;/head&gt;&quot;</span>
                <span class="s">&quot;&lt;body&gt;&lt;h1&gt;401 Unauthorized&lt;/h1&gt;&lt;/body&gt;&quot;</span>
                <span class="s">&quot;&lt;/html&gt;&quot;</span><span class="p">;</span>
            <span class="k">constexpr</span> <span class="kt">char</span> <span class="n">forbidden</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;&lt;html&gt;&quot;</span>
                                         <span class="s">&quot;&lt;head&gt;&lt;title&gt;Forbidden&lt;/title&gt;&lt;/head&gt;&quot;</span>
                                         <span class="s">&quot;&lt;body&gt;&lt;h1&gt;403 Forbidden&lt;/h1&gt;&lt;/body&gt;&quot;</span>
                                         <span class="s">&quot;&lt;/html&gt;&quot;</span><span class="p">;</span>
            <span class="k">constexpr</span> <span class="kt">char</span> <span class="n">not_found</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;&lt;html&gt;&quot;</span>
                                         <span class="s">&quot;&lt;head&gt;&lt;title&gt;Not Found&lt;/title&gt;&lt;/head&gt;&quot;</span>
                                         <span class="s">&quot;&lt;body&gt;&lt;h1&gt;404 Not Found&lt;/h1&gt;&lt;/body&gt;&quot;</span>
                                         <span class="s">&quot;&lt;/html&gt;&quot;</span><span class="p">;</span>
            <span class="k">constexpr</span> <span class="kt">char</span> <span class="n">internal_server_error</span><span class="p">[]</span> <span class="o">=</span>
                <span class="s">&quot;&lt;html&gt;&quot;</span>
                <span class="s">&quot;&lt;head&gt;&lt;title&gt;Internal Server Error&lt;/title&gt;&lt;/head&gt;&quot;</span>
                <span class="s">&quot;&lt;body&gt;&lt;h1&gt;500 Internal Server Error&lt;/h1&gt;&lt;/body&gt;&quot;</span>
                <span class="s">&quot;&lt;/html&gt;&quot;</span><span class="p">;</span>
            <span class="k">constexpr</span> <span class="kt">char</span> <span class="n">not_implemented</span><span class="p">[]</span> <span class="o">=</span>
                <span class="s">&quot;&lt;html&gt;&quot;</span>
                <span class="s">&quot;&lt;head&gt;&lt;title&gt;Not Implemented&lt;/title&gt;&lt;/head&gt;&quot;</span>
                <span class="s">&quot;&lt;body&gt;&lt;h1&gt;501 Not Implemented&lt;/h1&gt;&lt;/body&gt;&quot;</span>
                <span class="s">&quot;&lt;/html&gt;&quot;</span><span class="p">;</span>
            <span class="k">constexpr</span> <span class="kt">char</span> <span class="n">bad_gateway</span><span class="p">[]</span> <span class="o">=</span>
                <span class="s">&quot;&lt;html&gt;&quot;</span>
                <span class="s">&quot;&lt;head&gt;&lt;title&gt;Bad Gateway&lt;/title&gt;&lt;/head&gt;&quot;</span>
                <span class="s">&quot;&lt;body&gt;&lt;h1&gt;502 Bad Gateway&lt;/h1&gt;&lt;/body&gt;&quot;</span>
                <span class="s">&quot;&lt;/html&gt;&quot;</span><span class="p">;</span>
            <span class="k">constexpr</span> <span class="kt">char</span> <span class="n">service_unavailable</span><span class="p">[]</span> <span class="o">=</span>
                <span class="s">&quot;&lt;html&gt;&quot;</span>
                <span class="s">&quot;&lt;head&gt;&lt;title&gt;Service Unavailable&lt;/title&gt;&lt;/head&gt;&quot;</span>
                <span class="s">&quot;&lt;body&gt;&lt;h1&gt;503 Service Unavailable&lt;/h1&gt;&lt;/body&gt;&quot;</span>
                <span class="s">&quot;&lt;/html&gt;&quot;</span><span class="p">;</span>
        <span class="p">}</span> <span class="c1">// namespace as_string</span>

        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">to_string</span><span class="p">(</span><span class="n">reply</span><span class="o">::</span><span class="n">status_type</span> <span class="n">status</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">switch</span> <span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">ok</span><span class="p">:</span> <span class="c1">// NOLINT(bugprone-branch-clone)</span>
                <span class="k">return</span> <span class="n">as_string</span><span class="o">::</span><span class="n">ok</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">created</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">as_string</span><span class="o">::</span><span class="n">created</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">accepted</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">as_string</span><span class="o">::</span><span class="n">accepted</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">no_content</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">as_string</span><span class="o">::</span><span class="n">no_content</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">multiple_choices</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">as_string</span><span class="o">::</span><span class="n">multiple_choices</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">moved_permanently</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">as_string</span><span class="o">::</span><span class="n">moved_permanently</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">moved_temporarily</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">as_string</span><span class="o">::</span><span class="n">moved_temporarily</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">not_modified</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">as_string</span><span class="o">::</span><span class="n">not_modified</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">bad_request</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">as_string</span><span class="o">::</span><span class="n">bad_request</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">unauthorized</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">as_string</span><span class="o">::</span><span class="n">unauthorized</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">forbidden</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">as_string</span><span class="o">::</span><span class="n">forbidden</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">not_found</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">as_string</span><span class="o">::</span><span class="n">not_found</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">internal_server_error</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">as_string</span><span class="o">::</span><span class="n">internal_server_error</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">not_implemented</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">as_string</span><span class="o">::</span><span class="n">not_implemented</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">bad_gateway</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">as_string</span><span class="o">::</span><span class="n">bad_gateway</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">reply</span><span class="o">::</span><span class="nl">service_unavailable</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">as_string</span><span class="o">::</span><span class="n">service_unavailable</span><span class="p">;</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">as_string</span><span class="o">::</span><span class="n">internal_server_error</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="c1">// namespace stock_replies</span>

    <span class="n">reply</span> <span class="n">reply</span><span class="o">::</span><span class="n">stock_reply</span><span class="p">(</span><span class="n">reply</span><span class="o">::</span><span class="n">status_type</span> <span class="n">status</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">reply</span> <span class="n">rep</span><span class="p">;</span>
        <span class="n">rep</span><span class="p">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">status</span><span class="p">;</span>
        <span class="n">rep</span><span class="p">.</span><span class="n">headers</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
        <span class="n">rep</span><span class="p">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Content-Length&quot;</span><span class="p">;</span>
        <span class="n">rep</span><span class="p">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">stock_replies</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">status</span><span class="p">);</span>
        <span class="n">rep</span><span class="p">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">value</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">rep</span><span class="p">.</span><span class="n">content</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="n">rep</span><span class="p">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Content-Type&quot;</span><span class="p">;</span>
        <span class="n">rep</span><span class="p">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;text/html&quot;</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">rep</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span> <span class="c1">// namespace http::server</span>
</code></pre></div>
</td></tr></table>
<p>request_handler.cpp</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">//</span>
<span class="c1">// request_handler.cpp</span>
<span class="c1">// ~~~~~~~~~~~~~~~~~~~</span>
<span class="c1">//</span>
<span class="c1">// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)</span>
<span class="c1">//</span>
<span class="c1">// Distributed under the Boost Software License, Version 1.0. (See accompanying</span>
<span class="c1">// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)</span>
<span class="c1">//</span>

<span class="cp">#include</span> <span class="cpf">&quot;request_handler.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;mime_types.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;reply.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;request.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;fstream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;sstream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;utility&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">http</span><span class="o">::</span><span class="n">server</span> <span class="p">{</span>

    <span class="n">request_handler</span><span class="o">::</span><span class="n">request_handler</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">doc_root</span><span class="p">)</span>
        <span class="o">:</span> <span class="n">doc_root_</span><span class="p">(</span><span class="n">doc_root</span><span class="p">)</span> <span class="p">{}</span>

    <span class="kt">void</span> <span class="n">request_handler</span><span class="o">::</span><span class="n">handle_request</span><span class="p">(</span><span class="k">const</span> <span class="n">request</span> <span class="o">&amp;</span><span class="n">req</span><span class="p">,</span> <span class="n">reply</span> <span class="o">&amp;</span><span class="n">rep</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Decode url to path.</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">request_path</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">url_decode</span><span class="p">(</span><span class="n">req</span><span class="p">.</span><span class="n">uri</span><span class="p">,</span> <span class="n">request_path</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">rep</span> <span class="o">=</span> <span class="n">reply</span><span class="o">::</span><span class="n">stock_reply</span><span class="p">(</span><span class="n">reply</span><span class="o">::</span><span class="n">bad_request</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// Request path must be absolute and not contain &quot;..&quot;.</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">request_path</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">||</span> <span class="n">request_path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39;/&#39;</span> <span class="o">||</span>
            <span class="n">request_path</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;..&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">::</span><span class="n">npos</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">rep</span> <span class="o">=</span> <span class="n">reply</span><span class="o">::</span><span class="n">stock_reply</span><span class="p">(</span><span class="n">reply</span><span class="o">::</span><span class="n">bad_request</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// If path ends in slash (i.e. is a directory) then add</span>
        <span class="c1">// &quot;index.html&quot;.</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">request_path</span><span class="p">[</span><span class="n">request_path</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;/&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">request_path</span> <span class="o">+=</span> <span class="s">&quot;index.html&quot;</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// Determine the file extension.</span>
        <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">last_slash_pos</span> <span class="o">=</span> <span class="n">request_path</span><span class="p">.</span><span class="n">find_last_of</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">);</span>
        <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">last_dot_pos</span> <span class="o">=</span> <span class="n">request_path</span><span class="p">.</span><span class="n">find_last_of</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">);</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">extension</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">last_dot_pos</span> <span class="o">!=</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">::</span><span class="n">npos</span> <span class="o">&amp;&amp;</span>
            <span class="n">last_dot_pos</span> <span class="o">&gt;</span> <span class="n">last_slash_pos</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">extension</span> <span class="o">=</span> <span class="n">request_path</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">last_dot_pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// Open the file to send back.</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">full_path</span> <span class="o">=</span> <span class="n">doc_root_</span> <span class="o">+</span> <span class="n">request_path</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">ifstream</span> <span class="n">is</span><span class="p">(</span><span class="n">full_path</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="n">std</span><span class="o">::</span><span class="n">ios</span><span class="o">::</span><span class="n">in</span> <span class="o">|</span> <span class="n">std</span><span class="o">::</span><span class="n">ios</span><span class="o">::</span><span class="n">binary</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">is</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">rep</span> <span class="o">=</span> <span class="n">reply</span><span class="o">::</span><span class="n">stock_reply</span><span class="p">(</span><span class="n">reply</span><span class="o">::</span><span class="n">not_found</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// Fill out the reply to be sent to the client.</span>
        <span class="n">rep</span><span class="p">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">reply</span><span class="o">::</span><span class="n">ok</span><span class="p">;</span>
        <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">512</span><span class="p">];</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">is</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">)).</span><span class="n">gcount</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">rep</span><span class="p">.</span><span class="n">content</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">is</span><span class="p">.</span><span class="n">gcount</span><span class="p">());</span>
        <span class="n">rep</span><span class="p">.</span><span class="n">headers</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
        <span class="n">rep</span><span class="p">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Content-Length&quot;</span><span class="p">;</span>
        <span class="n">rep</span><span class="p">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">value</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">rep</span><span class="p">.</span><span class="n">content</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="n">rep</span><span class="p">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Content-Type&quot;</span><span class="p">;</span>
        <span class="n">rep</span><span class="p">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">value</span> <span class="o">=</span> <span class="n">mime_types</span><span class="o">::</span><span class="n">extension_to_type</span><span class="p">(</span><span class="n">extension</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">bool</span> <span class="n">request_handler</span><span class="o">::</span><span class="n">url_decode</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">in</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">out</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">out</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">out</span><span class="p">.</span><span class="n">reserve</span><span class="p">(</span><span class="n">in</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">in</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;%&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;=</span> <span class="n">in</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="p">{</span>
                    <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                    <span class="n">std</span><span class="o">::</span><span class="n">istringstream</span> <span class="n">is</span><span class="p">(</span><span class="n">in</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">is</span> <span class="o">&gt;&gt;</span> <span class="n">std</span><span class="o">::</span><span class="n">hex</span> <span class="o">&gt;&gt;</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
                        <span class="n">out</span> <span class="o">+=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;+&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">out</span> <span class="o">+=</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">out</span> <span class="o">+=</span> <span class="n">in</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span> <span class="c1">// namespace http::server</span>
</code></pre></div>
</td></tr></table>
<p>connection.cpp</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">//</span>
<span class="c1">// connection.cpp</span>
<span class="c1">// ~~~~~~~~~~~~~~</span>
<span class="c1">//</span>
<span class="c1">// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)</span>
<span class="c1">//</span>
<span class="c1">// Distributed under the Boost Software License, Version 1.0. (See accompanying</span>
<span class="c1">// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)</span>
<span class="c1">//</span>

<span class="cp">#include</span> <span class="cpf">&quot;connection.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;connection_manager.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;request_handler.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;utility&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">http</span><span class="o">::</span><span class="n">server</span> <span class="p">{</span>

    <span class="n">connection</span><span class="o">::</span><span class="n">connection</span><span class="p">(</span><span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">socket</span> <span class="n">socket</span><span class="p">,</span>
                           <span class="n">connection_manager</span> <span class="o">&amp;</span><span class="n">manager</span><span class="p">,</span>
                           <span class="n">request_handler</span> <span class="o">&amp;</span><span class="n">handler</span><span class="p">)</span>
        <span class="o">:</span> <span class="n">socket_</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">socket</span><span class="p">)),</span> <span class="n">connection_manager_</span><span class="p">(</span><span class="n">manager</span><span class="p">),</span>
          <span class="n">request_handler_</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span> <span class="p">{}</span>

    <span class="kt">void</span> <span class="n">connection</span><span class="o">::</span><span class="n">start</span><span class="p">()</span> <span class="p">{</span> <span class="n">do_read</span><span class="p">();</span> <span class="p">}</span>

    <span class="kt">void</span> <span class="n">connection</span><span class="o">::</span><span class="n">stop</span><span class="p">()</span> <span class="p">{</span> <span class="n">socket_</span><span class="p">.</span><span class="n">close</span><span class="p">();</span> <span class="p">}</span>

    <span class="kt">void</span> <span class="n">connection</span><span class="o">::</span><span class="n">do_read</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">auto</span> <span class="nf">self</span><span class="p">(</span><span class="n">shared_from_this</span><span class="p">());</span>
        <span class="n">socket_</span><span class="p">.</span><span class="n">async_read_some</span><span class="p">(</span>
            <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">buffer_</span><span class="p">),</span>
            <span class="p">[</span><span class="k">this</span><span class="p">,</span> <span class="n">self</span><span class="p">](</span><span class="n">std</span><span class="o">::</span><span class="n">error_code</span> <span class="n">ec</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">bytes_transferred</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ec</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">request_parser</span><span class="o">::</span><span class="n">result_type</span> <span class="n">result</span><span class="p">;</span>
                    <span class="n">std</span><span class="o">::</span><span class="n">tie</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">ignore</span><span class="p">)</span> <span class="o">=</span> <span class="n">request_parser_</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span>
                        <span class="n">request_</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span>
                        <span class="n">buffer_</span><span class="p">.</span><span class="n">data</span><span class="p">()</span> <span class="o">+</span> <span class="n">bytes_transferred</span><span class="p">);</span>

                    <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="n">request_parser</span><span class="o">::</span><span class="n">good</span><span class="p">)</span> <span class="p">{</span>
                        <span class="n">request_handler_</span><span class="p">.</span><span class="n">handle_request</span><span class="p">(</span><span class="n">request_</span><span class="p">,</span> <span class="n">reply_</span><span class="p">);</span>
                        <span class="n">do_write</span><span class="p">();</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="n">request_parser</span><span class="o">::</span><span class="n">bad</span><span class="p">)</span> <span class="p">{</span>
                        <span class="n">reply_</span> <span class="o">=</span> <span class="n">reply</span><span class="o">::</span><span class="n">stock_reply</span><span class="p">(</span><span class="n">reply</span><span class="o">::</span><span class="n">bad_request</span><span class="p">);</span>
                        <span class="n">do_write</span><span class="p">();</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="n">do_read</span><span class="p">();</span>
                    <span class="p">}</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ec</span> <span class="o">!=</span> <span class="n">asio</span><span class="o">::</span><span class="n">error</span><span class="o">::</span><span class="n">operation_aborted</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">connection_manager_</span><span class="p">.</span><span class="n">stop</span><span class="p">(</span><span class="n">shared_from_this</span><span class="p">());</span>
                <span class="p">}</span>
            <span class="p">});</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">connection</span><span class="o">::</span><span class="n">do_write</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">auto</span> <span class="nf">self</span><span class="p">(</span><span class="n">shared_from_this</span><span class="p">());</span>
        <span class="n">asio</span><span class="o">::</span><span class="n">async_write</span><span class="p">(</span><span class="n">socket_</span><span class="p">,</span> <span class="n">reply_</span><span class="p">.</span><span class="n">to_buffers</span><span class="p">(),</span>
                          <span class="p">[</span><span class="k">this</span><span class="p">,</span> <span class="n">self</span><span class="p">](</span><span class="n">std</span><span class="o">::</span><span class="n">error_code</span> <span class="n">ec</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">)</span> <span class="p">{</span>
                              <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ec</span><span class="p">)</span> <span class="p">{</span>
                                  <span class="c1">// Initiate graceful connection closure.</span>
                                  <span class="n">asio</span><span class="o">::</span><span class="n">error_code</span> <span class="n">ignored_ec</span><span class="p">;</span>
                                  <span class="n">socket_</span><span class="p">.</span><span class="n">shutdown</span><span class="p">(</span>
                                      <span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">socket</span><span class="o">::</span><span class="n">shutdown_both</span><span class="p">,</span>
                                      <span class="n">ignored_ec</span><span class="p">);</span>
                              <span class="p">}</span>

                              <span class="k">if</span> <span class="p">(</span><span class="n">ec</span> <span class="o">!=</span> <span class="n">asio</span><span class="o">::</span><span class="n">error</span><span class="o">::</span><span class="n">operation_aborted</span><span class="p">)</span> <span class="p">{</span>
                                  <span class="n">connection_manager_</span><span class="p">.</span><span class="n">stop</span><span class="p">(</span><span class="n">shared_from_this</span><span class="p">());</span>
                              <span class="p">}</span>
                          <span class="p">});</span>
    <span class="p">}</span>

<span class="p">}</span> <span class="c1">// namespace http::server</span>
</code></pre></div>
</td></tr></table>
<p>connection_manager.cpp</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">//</span>
<span class="c1">// connection_manager.cpp</span>
<span class="c1">// ~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="c1">//</span>
<span class="c1">// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)</span>
<span class="c1">//</span>
<span class="c1">// Distributed under the Boost Software License, Version 1.0. (See accompanying</span>
<span class="c1">// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)</span>
<span class="c1">//</span>

<span class="cp">#include</span> <span class="cpf">&quot;connection_manager.hpp&quot;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">http</span><span class="o">::</span><span class="n">server</span> <span class="p">{</span>

    <span class="n">connection_manager</span><span class="o">::</span><span class="n">connection_manager</span><span class="p">()</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>

    <span class="kt">void</span> <span class="n">connection_manager</span><span class="o">::</span><span class="n">start</span><span class="p">(</span><span class="n">connection_ptr</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">connections_</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
        <span class="n">c</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">connection_manager</span><span class="o">::</span><span class="n">stop</span><span class="p">(</span><span class="n">connection_ptr</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">connections_</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
        <span class="n">c</span><span class="o">-&gt;</span><span class="n">stop</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">connection_manager</span><span class="o">::</span><span class="n">stop_all</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">c</span> <span class="p">:</span> <span class="n">connections_</span><span class="p">)</span>
            <span class="n">c</span><span class="o">-&gt;</span><span class="n">stop</span><span class="p">();</span>
        <span class="n">connections_</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
    <span class="p">}</span>

<span class="p">}</span> <span class="c1">// namespace http::server</span>
</code></pre></div>
</td></tr></table>
<p>server.cpp</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">//</span>
<span class="c1">// server.cpp</span>
<span class="c1">// ~~~~~~~~~~</span>
<span class="c1">//</span>
<span class="c1">// Copyright (c) 2003-2020 Christopher M. Kohlhoff (chris at kohlhoff dot com)</span>
<span class="c1">//</span>
<span class="c1">// Distributed under the Boost Software License, Version 1.0. (See accompanying</span>
<span class="c1">// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)</span>
<span class="c1">//</span>

<span class="cp">#include</span> <span class="cpf">&quot;server.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;csignal&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;utility&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">http</span><span class="o">::</span><span class="n">server</span> <span class="p">{</span>

    <span class="n">server</span><span class="o">::</span><span class="n">server</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">address</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">port</span><span class="p">,</span>
                   <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">doc_root</span><span class="p">)</span>
        <span class="o">:</span> <span class="n">io_context_</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">signals_</span><span class="p">(</span><span class="n">io_context_</span><span class="p">),</span> <span class="n">acceptor_</span><span class="p">(</span><span class="n">io_context_</span><span class="p">),</span>
          <span class="n">connection_manager_</span><span class="p">(),</span> <span class="n">request_handler_</span><span class="p">(</span><span class="n">doc_root</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">setup_signals</span><span class="p">();</span>
        <span class="n">setup_acceptor</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">port</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">server</span><span class="o">::</span><span class="n">setup_acceptor</span><span class="p">(</span>
        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">address</span><span class="p">,</span>
        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">port</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Open the acceptor with the option to</span>
                                   <span class="c1">// reuse the address (i.e.</span>
        <span class="c1">// SO_REUSEADDR).</span>
        <span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">resolver</span> <span class="n">resolver</span><span class="p">(</span><span class="n">io_context_</span><span class="p">);</span>
        <span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">endpoint</span> <span class="n">endpoint</span> <span class="o">=</span>
            <span class="o">*</span><span class="n">resolver</span><span class="p">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">port</span><span class="p">).</span><span class="n">begin</span><span class="p">();</span>
        <span class="n">acceptor_</span><span class="p">.</span><span class="n">open</span><span class="p">(</span><span class="n">endpoint</span><span class="p">.</span><span class="n">protocol</span><span class="p">());</span>
        <span class="n">acceptor_</span><span class="p">.</span><span class="n">set_option</span><span class="p">(</span><span class="n">asio</span><span class="o">::</span><span class="n">socket_base</span><span class="o">::</span><span class="n">reuse_address</span><span class="p">(</span><span class="nb">true</span><span class="p">));</span>
        <span class="n">acceptor_</span><span class="p">.</span><span class="n">bind</span><span class="p">(</span><span class="n">endpoint</span><span class="p">);</span>
        <span class="n">acceptor_</span><span class="p">.</span><span class="n">listen</span><span class="p">();</span>

        <span class="n">do_accept</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="n">server</span><span class="o">::</span><span class="n">setup_signals</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// Register to handle the signals that</span>
        <span class="c1">// indicate when the server</span>
        <span class="c1">// should exit. It is safe to register for the same signal multiple</span>
        <span class="c1">// times in a program, provided all registration for the specified</span>
        <span class="c1">// signal is made through Asio.</span>
        <span class="n">signals_</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">SIGINT</span><span class="p">);</span>
        <span class="n">signals_</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">SIGTERM</span><span class="p">);</span>
<span class="cp">#if defined(SIGQUIT)</span>
        <span class="n">signals_</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">SIGQUIT</span><span class="p">);</span>
<span class="cp">#endif </span><span class="c1">// defined(SIGQUIT)</span>
        <span class="n">do_await_stop</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">server</span><span class="o">::</span><span class="n">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// The io_context::run() call will block until all asynchronous</span>
        <span class="c1">// operations have finished. While the server is running, there is</span>
        <span class="c1">// always at least one asynchronous operation outstanding: the</span>
        <span class="c1">// asynchronous accept call waiting for new incoming connections.</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kr">thread</span><span class="o">::</span><span class="n">hardware_concurrency</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">asio</span><span class="o">::</span><span class="n">post</span><span class="p">(</span><span class="n">pool_</span><span class="p">,</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">]</span> <span class="p">{</span> <span class="n">io_context_</span><span class="p">.</span><span class="n">run</span><span class="p">();</span> <span class="p">});</span>
        <span class="p">}</span>
        <span class="n">pool_</span><span class="p">.</span><span class="n">join</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">server</span><span class="o">::</span><span class="n">do_accept</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">acceptor_</span><span class="p">.</span><span class="n">async_accept</span><span class="p">([</span><span class="k">this</span><span class="p">](</span><span class="n">std</span><span class="o">::</span><span class="n">error_code</span> <span class="n">ec</span><span class="p">,</span>
                                      <span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">socket</span> <span class="n">socket</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Check whether the server was stopped by a signal before</span>
            <span class="c1">// this completion handler had a chance to run.</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">acceptor_</span><span class="p">.</span><span class="n">is_open</span><span class="p">())</span> <span class="p">{</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ec</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">connection_manager_</span><span class="p">.</span><span class="n">start</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">connection</span><span class="o">&gt;</span><span class="p">(</span>
                    <span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">socket</span><span class="p">),</span> <span class="n">connection_manager_</span><span class="p">,</span> <span class="n">request_handler_</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">do_accept</span><span class="p">();</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="n">server</span><span class="o">::</span><span class="n">do_await_stop</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">signals_</span><span class="p">.</span><span class="n">async_wait</span><span class="p">([</span><span class="k">this</span><span class="p">](</span><span class="n">std</span><span class="o">::</span><span class="n">error_code</span> <span class="cm">/*ec*/</span><span class="p">,</span> <span class="kt">int</span> <span class="cm">/*signo*/</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// The server is stopped by cancelling all outstanding</span>
            <span class="c1">// asynchronous operations. Once all operations have finished</span>
            <span class="c1">// the io_context::run() call will exit.</span>
            <span class="n">acceptor_</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
            <span class="n">connection_manager_</span><span class="p">.</span><span class="n">stop_all</span><span class="p">();</span>
        <span class="p">});</span>
    <span class="p">}</span>

<span class="p">}</span> <span class="c1">// namespace http::server</span>
</code></pre></div>
</td></tr></table>
<!-- Generated with mdsplit: https://github.com/alandefreitas/mdsplit -->
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../async-network/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Async Network
              </div>
            </div>
          </a>
        
        
          <a href="../../../guis/build-script/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Build script
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 Alan Freitas
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.18f0862e.min.js"></script>
      <script src="../../../assets/javascripts/bundle.994580cf.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: ['toc.integrate', 'header.autohide'],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>