
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Modern C++ Snippets">
      
      
      
      
        <link rel="canonical" href="https://alandefreitas.github.io/moderncpp/utilities/networking/async-network/">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.8">
    
    
      
        <title>Async Network - Modern C++</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-109858331-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#async-network" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://alandefreitas.github.io/moderncpp/" title="Modern C++" class="md-header-nav__button md-logo" aria-label="Modern C++">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Modern C++
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Async Network
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/alandefreitas/moderncpp" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    alandefreitas/moderncpp
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://alandefreitas.github.io/moderncpp/" title="Modern C++" class="md-nav__button md-logo" aria-label="Modern C++">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Modern C++
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/alandefreitas/moderncpp" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    alandefreitas/moderncpp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../quick-start/" class="md-nav__link">
        Quick Start
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
      
      <label class="md-nav__link" for="nav-3">
        Basic Syntax
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Basic Syntax" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          Basic Syntax
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1" >
      
      <label class="md-nav__link" for="nav-3-1">
        Input / Output
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Input / Output" data-md-level="2">
        <label class="md-nav__title" for="nav-3-1">
          <span class="md-nav__icon md-icon"></span>
          Input / Output
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/input--output/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/input--output/hello-world/" class="md-nav__link">
        Hello World
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/input--output/input/" class="md-nav__link">
        Input
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/input--output/output/" class="md-nav__link">
        Output
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/input--output/format/" class="md-nav__link">
        Format
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/input--output/tabulate/" class="md-nav__link">
        Tabulate
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" >
      
      <label class="md-nav__link" for="nav-3-2">
        Control flow
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Control flow" data-md-level="2">
        <label class="md-nav__title" for="nav-3-2">
          <span class="md-nav__icon md-icon"></span>
          Control flow
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/control-flow/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/control-flow/sequential/" class="md-nav__link">
        Sequential
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/control-flow/conditional/" class="md-nav__link">
        Conditional
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/control-flow/loops/" class="md-nav__link">
        Loops
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3" >
      
      <label class="md-nav__link" for="nav-3-3">
        Data types
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Data types" data-md-level="2">
        <label class="md-nav__title" for="nav-3-3">
          <span class="md-nav__icon md-icon"></span>
          Data types
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/data-types/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/data-types/fundamental-data-types/" class="md-nav__link">
        Fundamental Data Types
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/data-types/operators/" class="md-nav__link">
        Operators
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/data-types/auto/" class="md-nav__link">
        Auto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/data-types/constants/" class="md-nav__link">
        Constants
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4" >
      
      <label class="md-nav__link" for="nav-3-4">
        Basic Data Types
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Basic Data Types" data-md-level="2">
        <label class="md-nav__title" for="nav-3-4">
          <span class="md-nav__icon md-icon"></span>
          Basic Data Types
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/basic-data-types/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/basic-data-types/raw-arrays/" class="md-nav__link">
        Raw arrays
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/basic-data-types/arrays/" class="md-nav__link">
        Arrays
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/basic-data-types/vectors/" class="md-nav__link">
        Vectors
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/basic-data-types/strings/" class="md-nav__link">
        Strings
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/basic-data-types/move/" class="md-nav__link">
        Move
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/basic-data-types/aggregate-initialization/" class="md-nav__link">
        Aggregate initialization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/basic-data-types/structured-binding/" class="md-nav__link">
        Structured binding
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5" >
      
      <label class="md-nav__link" for="nav-3-5">
        Pointers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pointers" data-md-level="2">
        <label class="md-nav__title" for="nav-3-5">
          <span class="md-nav__icon md-icon"></span>
          Pointers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/pointers/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/pointers/raw-pointers/" class="md-nav__link">
        Raw Pointers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/pointers/smart-pointers/" class="md-nav__link">
        Smart pointers
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6" >
      
      <label class="md-nav__link" for="nav-3-6">
        Functions
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Functions" data-md-level="2">
        <label class="md-nav__title" for="nav-3-6">
          <span class="md-nav__icon md-icon"></span>
          Functions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/functions/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/functions/function/" class="md-nav__link">
        Function
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/functions/lambda/" class="md-nav__link">
        Lambda
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-7" type="checkbox" id="nav-3-7" >
      
      <label class="md-nav__link" for="nav-3-7">
        Files
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Files" data-md-level="2">
        <label class="md-nav__title" for="nav-3-7">
          <span class="md-nav__icon md-icon"></span>
          Files
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/files/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/files/file-streams/" class="md-nav__link">
        File streams
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-syntax/files/filesystem/" class="md-nav__link">
        Filesystem
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
      
      <label class="md-nav__link" for="nav-4">
        Algorithms / Data Structures
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Algorithms / Data Structures" data-md-level="1">
        <label class="md-nav__title" for="nav-4">
          <span class="md-nav__icon md-icon"></span>
          Algorithms / Data Structures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-1" type="checkbox" id="nav-4-1" >
      
      <label class="md-nav__link" for="nav-4-1">
        Date and time
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Date and time" data-md-level="2">
        <label class="md-nav__title" for="nav-4-1">
          <span class="md-nav__icon md-icon"></span>
          Date and time
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/date-and-time/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/date-and-time/clock/" class="md-nav__link">
        Clock
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/date-and-time/datetime/" class="md-nav__link">
        Datetime
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2" >
      
      <label class="md-nav__link" for="nav-4-2">
        Random
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Random" data-md-level="2">
        <label class="md-nav__title" for="nav-4-2">
          <span class="md-nav__icon md-icon"></span>
          Random
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/random/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/random/random/" class="md-nav__link">
        Random
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/random/pcg/" class="md-nav__link">
        PCG
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3" >
      
      <label class="md-nav__link" for="nav-4-3">
        Template
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Template" data-md-level="2">
        <label class="md-nav__title" for="nav-4-3">
          <span class="md-nav__icon md-icon"></span>
          Template
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/template/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/template/template-function/" class="md-nav__link">
        Template function
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/template/template-aliases/" class="md-nav__link">
        Template aliases
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/template/concepts/" class="md-nav__link">
        Concepts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/template/sfinae/" class="md-nav__link">
        SFINAE
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4" >
      
      <label class="md-nav__link" for="nav-4-4">
        Algorithm
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Algorithm" data-md-level="2">
        <label class="md-nav__title" for="nav-4-4">
          <span class="md-nav__icon md-icon"></span>
          Algorithm
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/algorithm/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/algorithm/searching/" class="md-nav__link">
        Searching
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/algorithm/sorting/" class="md-nav__link">
        Sorting
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/algorithm/basic-algorithms/" class="md-nav__link">
        Basic Algorithms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/algorithm/ranges/" class="md-nav__link">
        Ranges
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5" >
      
      <label class="md-nav__link" for="nav-4-5">
        Data structures
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Data structures" data-md-level="2">
        <label class="md-nav__title" for="nav-4-5">
          <span class="md-nav__icon md-icon"></span>
          Data structures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/data-structures/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/data-structures/sequential-containers/" class="md-nav__link">
        Sequential Containers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/data-structures/associative-containers/" class="md-nav__link">
        Associative Containers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/data-structures/memory-resource/" class="md-nav__link">
        Memory resource
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/data-structures/span/" class="md-nav__link">
        Span
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/data-structures/bitset/" class="md-nav__link">
        Bitset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/data-structures/spatial-containers/" class="md-nav__link">
        Spatial Containers
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-6" type="checkbox" id="nav-4-6" >
      
      <label class="md-nav__link" for="nav-4-6">
        Heterogeneous Types
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Heterogeneous Types" data-md-level="2">
        <label class="md-nav__title" for="nav-4-6">
          <span class="md-nav__icon md-icon"></span>
          Heterogeneous Types
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/heterogeneous-types/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/heterogeneous-types/tuples/" class="md-nav__link">
        Tuples
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/heterogeneous-types/any/" class="md-nav__link">
        Any
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/heterogeneous-types/optional/" class="md-nav__link">
        Optional
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms--data-structures/heterogeneous-types/variant/" class="md-nav__link">
        Variant
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" >
      
      <label class="md-nav__link" for="nav-5">
        Programming Paradigms
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Programming Paradigms" data-md-level="1">
        <label class="md-nav__title" for="nav-5">
          <span class="md-nav__icon md-icon"></span>
          Programming Paradigms
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-1" type="checkbox" id="nav-5-1" >
      
      <label class="md-nav__link" for="nav-5-1">
        Basic Paradigms
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Basic Paradigms" data-md-level="2">
        <label class="md-nav__title" for="nav-5-1">
          <span class="md-nav__icon md-icon"></span>
          Basic Paradigms
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/basic-paradigms/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/basic-paradigms/polymorphism/" class="md-nav__link">
        Polymorphism
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/basic-paradigms/shared-from-this/" class="md-nav__link">
        Shared from this
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/basic-paradigms/metaprogramming/" class="md-nav__link">
        Metaprogramming
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/basic-paradigms/crtp/" class="md-nav__link">
        CRTP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/basic-paradigms/sfinae/" class="md-nav__link">
        SFINAE
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2" >
      
      <label class="md-nav__link" for="nav-5-2">
        Parallelism
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Parallelism" data-md-level="2">
        <label class="md-nav__title" for="nav-5-2">
          <span class="md-nav__icon md-icon"></span>
          Parallelism
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/parallelism/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/parallelism/execution-policies/" class="md-nav__link">
        Execution Policies
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/parallelism/threads/" class="md-nav__link">
        Threads
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/parallelism/executors/" class="md-nav__link">
        Executors
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/parallelism/timers/" class="md-nav__link">
        Timers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/parallelism/signals/" class="md-nav__link">
        Signals
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming-paradigms/parallelism/async/" class="md-nav__link">
        Async++
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
      
      <label class="md-nav__link" for="nav-6">
        Utilities
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Utilities" data-md-level="1">
        <label class="md-nav__title" for="nav-6">
          <span class="md-nav__icon md-icon"></span>
          Utilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-1" type="checkbox" id="nav-6-1" >
      
      <label class="md-nav__link" for="nav-6-1">
        Regular Expressions
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Regular Expressions" data-md-level="2">
        <label class="md-nav__title" for="nav-6-1">
          <span class="md-nav__icon md-icon"></span>
          Regular Expressions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../regular-expressions/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../regular-expressions/regex/" class="md-nav__link">
        Regex
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2" checked>
      
      <label class="md-nav__link" for="nav-6-2">
        Networking
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Networking" data-md-level="2">
        <label class="md-nav__title" for="nav-6-2">
          <span class="md-nav__icon md-icon"></span>
          Networking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../network/" class="md-nav__link">
        Network
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Async Network
      </a>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../http-server/" class="md-nav__link">
        Http server
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" >
      
      <label class="md-nav__link" for="nav-7">
        GUIs
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="GUIs" data-md-level="1">
        <label class="md-nav__title" for="nav-7">
          <span class="md-nav__icon md-icon"></span>
          GUIs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guis/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guis/qt/" class="md-nav__link">
        Qt
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guis/opengl--sdl/" class="md-nav__link">
        OpenGL + SDL
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guis/opengl--glfw/" class="md-nav__link">
        OpenGL + GLFW
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guis/imgui/" class="md-nav__link">
        IMGUI
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guis/webview/" class="md-nav__link">
        Webview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guis/system-tray/" class="md-nav__link">
        System tray
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8" >
      
      <label class="md-nav__link" for="nav-8">
        Testing
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Testing" data-md-level="1">
        <label class="md-nav__title" for="nav-8">
          <span class="md-nav__icon md-icon"></span>
          Testing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/build-script/" class="md-nav__link">
        Build script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/catch2/" class="md-nav__link">
        Catch2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/boostut/" class="md-nav__link">
        boost.ut
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/source-location/" class="md-nav__link">
        Source Location
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/plots/" class="md-nav__link">
        Plots
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../cmake-functions/" class="md-nav__link">
        CMake functions
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10" >
      
      <label class="md-nav__link" for="nav-10">
        Installing a C++20 compiler
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installing a C++20 compiler" data-md-level="1">
        <label class="md-nav__title" for="nav-10">
          <span class="md-nav__icon md-icon"></span>
          Installing a C++20 compiler
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../installing-a-c20-compiler/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../installing-a-c20-compiler/linux/" class="md-nav__link">
        Linux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../installing-a-c20-compiler/mac-os/" class="md-nav__link">
        Mac OS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../installing-a-c20-compiler/windows/" class="md-nav__link">
        Windows
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../get-involved/" class="md-nav__link">
        Get involved
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="async-network">Async Network</h1>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&quot;asio.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;memory&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;utility&gt;</span><span class="cp"></span>

<span class="c1">// https://think-async.com/Asio/asio-1.16.1/src/examples/cpp11/echo/async_tcp_echo_server.cpp</span>
<span class="k">class</span> <span class="nc">session</span> <span class="o">:</span> <span class="k">public</span> <span class="n">std</span><span class="o">::</span><span class="n">enable_shared_from_this</span><span class="o">&lt;</span><span class="n">session</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="k">public</span><span class="o">:</span>
    <span class="c1">// Create a session to a client</span>
    <span class="c1">// The session just wraps a socket to communicate with the client</span>
    <span class="k">explicit</span> <span class="n">session</span><span class="p">(</span><span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">socket</span> <span class="n">socket</span><span class="p">)</span>
        <span class="o">:</span> <span class="n">socket_</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">socket</span><span class="p">))</span> <span class="p">{}</span>

    <span class="c1">// Start the session</span>
    <span class="kt">void</span> <span class="n">start</span><span class="p">()</span> <span class="p">{</span> <span class="n">do_read</span><span class="p">();</span> <span class="p">}</span>

  <span class="k">private</span><span class="o">:</span>
    <span class="c1">// Read whatever the client sent us</span>
    <span class="kt">void</span> <span class="n">do_read</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Create another pointer to this session</span>
        <span class="c1">// - These pointers are useful to make sure there is always</span>
        <span class="c1">//   some shared pointer pointing to this session object</span>
        <span class="k">auto</span> <span class="nf">self</span><span class="p">(</span><span class="n">shared_from_this</span><span class="p">());</span>

        <span class="c1">// Read some data from the client</span>
        <span class="c1">// - We read little by little to make sure everything is OK</span>
        <span class="c1">// - This is better than reading all at once</span>
        <span class="c1">// - We read max_length bytes at a time</span>
        <span class="c1">// - We can also use a future instead of a callback:</span>
        <span class="c1">//   std::future&lt;size_t&gt; r =</span>
        <span class="c1">//      socket_.async_read_some(asio::buffer(...), asio::use_future);</span>
        <span class="n">socket_</span><span class="p">.</span><span class="n">async_read_some</span><span class="p">(</span>
            <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">data_</span><span class="p">,</span> <span class="n">max_length</span><span class="p">),</span>
            <span class="p">[</span><span class="k">this</span><span class="p">,</span> <span class="n">self</span><span class="p">](</span><span class="n">std</span><span class="o">::</span><span class="n">error_code</span> <span class="n">ec</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// If there was no error reading the message,</span>
                <span class="c1">// write a response to the client</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ec</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Client sent: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
                    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">data_</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
                    <span class="n">do_write</span><span class="p">(</span><span class="n">length</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">});</span>
    <span class="p">}</span>

    <span class="c1">// NOLINTNEXTLINE(readability-convert-member-functions-to-static)</span>
    <span class="kt">void</span> <span class="n">do_write</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Create another shared pointer to this to make sure it does die</span>
        <span class="k">auto</span> <span class="nf">self</span><span class="p">(</span><span class="n">shared_from_this</span><span class="p">());</span>

        <span class="c1">// Write a response asynchronously</span>
        <span class="c1">// - In this example, we write the same data back to the client</span>
        <span class="n">asio</span><span class="o">::</span><span class="n">async_write</span><span class="p">(</span>
            <span class="n">socket_</span><span class="p">,</span> <span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">data_</span><span class="p">,</span> <span class="n">length</span><span class="p">),</span>
            <span class="p">[</span><span class="k">this</span><span class="p">,</span> <span class="n">self</span><span class="p">](</span><span class="n">std</span><span class="o">::</span><span class="n">error_code</span> <span class="n">ec</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="cm">/*length*/</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// If there is no error</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ec</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Server replied with: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
                    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">data_</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
                    <span class="c1">// Starting reading from the client again</span>
                    <span class="n">do_read</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">});</span>
    <span class="p">}</span>

    <span class="c1">// Socket representing connection to client</span>
    <span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">socket</span> <span class="n">socket_</span><span class="p">;</span>

    <span class="c1">// Max length of the messages</span>
    <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">size_t</span> <span class="n">max_length</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">;</span>

    <span class="c1">// Array to keep messages</span>
    <span class="kt">char</span> <span class="n">data_</span><span class="p">[</span><span class="n">max_length</span><span class="p">]{};</span>
<span class="p">};</span>

<span class="c1">// Class to manage the acceptor</span>
<span class="k">class</span> <span class="nc">server</span> <span class="p">{</span>
  <span class="k">public</span><span class="o">:</span>
    <span class="c1">// Construct server on a port</span>
    <span class="c1">// - The server just wraps the acceptor and starts a session whenever</span>
    <span class="c1">//   the client connects</span>
    <span class="n">server</span><span class="p">(</span><span class="n">asio</span><span class="o">::</span><span class="n">io_context</span> <span class="o">&amp;</span><span class="n">io_context</span><span class="p">,</span> <span class="kt">short</span> <span class="n">port</span><span class="p">)</span>
        <span class="o">:</span> <span class="n">acceptor_</span><span class="p">(</span><span class="n">io_context</span><span class="p">,</span>
                    <span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">endpoint</span><span class="p">(</span><span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">v4</span><span class="p">(),</span> <span class="n">port</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">do_accept</span><span class="p">();</span>
    <span class="p">}</span>

  <span class="k">private</span><span class="o">:</span>
    <span class="c1">// Listen for connection</span>
    <span class="kt">void</span> <span class="n">do_accept</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Listening on http://localhost:&quot;</span>
                  <span class="o">&lt;&lt;</span> <span class="n">acceptor_</span><span class="p">.</span><span class="n">local_endpoint</span><span class="p">().</span><span class="n">port</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
        <span class="c1">// Wait for connection</span>
        <span class="c1">// - Wait for a connection</span>
        <span class="c1">// - Open http://localhost:8080 in your browser</span>
        <span class="n">acceptor_</span><span class="p">.</span><span class="n">async_accept</span><span class="p">(</span>
            <span class="p">[</span><span class="k">this</span><span class="p">](</span><span class="n">std</span><span class="o">::</span><span class="n">error_code</span> <span class="n">ec</span><span class="p">,</span> <span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">socket</span> <span class="n">socket</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// If there is no error, create a socket and reply</span>
                <span class="c1">// - The session object wraps the a socket to create response</span>
                <span class="c1">// - The session will manage a single connection to a user</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ec</span><span class="p">)</span> <span class="p">{</span>
                    <span class="c1">// Start the session</span>
                    <span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">session</span><span class="o">&gt;</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">socket</span><span class="p">))</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">();</span>
                <span class="p">}</span>

                <span class="c1">// Accept another connection</span>
                <span class="c1">// - The session will work asynchronously</span>
                <span class="c1">// - While the session will start to read the message,</span>
                <span class="c1">//   the server already starts listening no another connection.</span>
                <span class="n">do_accept</span><span class="p">();</span>
            <span class="p">});</span>
    <span class="p">}</span>

  <span class="k">private</span> <span class="cm">/* members */</span><span class="o">:</span>
    <span class="c1">// The only member we need is an acceptor for the server</span>
    <span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">acceptor</span> <span class="n">acceptor_</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="c1">// Create io_context as usual</span>
        <span class="n">asio</span><span class="o">::</span><span class="n">io_context</span> <span class="n">io_context</span><span class="p">;</span>

        <span class="c1">// We put all the logic inside a server object</span>
        <span class="c1">// - Nothing forbids us from organizing the server</span>
        <span class="c1">//   in any other way.</span>
        <span class="n">server</span> <span class="n">s</span><span class="p">(</span><span class="n">io_context</span><span class="p">,</span> <span class="mi">8080</span><span class="p">);</span>

        <span class="c1">// Run the io_context</span>
        <span class="c1">// - The server async functions will queue tasks in the io_context</span>
        <span class="c1">// - This function runs the io_context while there&#39;s work to do</span>
        <span class="c1">// - There is always going to be work to do because the server</span>
        <span class="c1">//   is always listening</span>
        <span class="n">asio</span><span class="o">::</span><span class="n">thread_pool</span> <span class="n">pool</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kr">thread</span><span class="o">::</span><span class="n">hardware_concurrency</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">asio</span><span class="o">::</span><span class="n">post</span><span class="p">(</span><span class="n">pool</span><span class="p">,</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">]</span> <span class="p">{</span>
                <span class="c1">// We run the io_context from the threads</span>
                <span class="c1">// - This allows us the io_context to send work to whatever</span>
                <span class="c1">//   thread seems best</span>
                <span class="n">io_context</span><span class="p">.</span><span class="n">run</span><span class="p">();</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">exception</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Report any exceptions</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Exception: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<!-- Generated with mdsplit: https://github.com/alandefreitas/mdsplit -->
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../network/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Network
              </div>
            </div>
          </a>
        
        
          <a href="../http-server/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Http server
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 Alan Freitas
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.18f0862e.min.js"></script>
      <script src="../../../assets/javascripts/bundle.994580cf.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: ['toc.integrate', 'header.autohide'],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>